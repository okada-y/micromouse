ARM GAS  C:\Temp\ccj03XTy.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"mouse_state.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.Get_diff_right_count,"ax",%progbits
  18              		.align	1
  19              		.global	Get_diff_right_count
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	Get_diff_right_count:
  27              	.LFB4:
  28              		.file 1 "Src/mouse_state.c"
   1:Src/mouse_state.c **** /*
   2:Src/mouse_state.c ****  * mouse_state.c
   3:Src/mouse_state.c ****  *
   4:Src/mouse_state.c ****  *  Created on: Feb 1, 2020
   5:Src/mouse_state.c ****  *      Author: 岡田 泰裕
   6:Src/mouse_state.c ****  */
   7:Src/mouse_state.c **** 
   8:Src/mouse_state.c **** #include <stdio.h>
   9:Src/mouse_state.c **** #include "param.h"
  10:Src/mouse_state.c **** #include "encorder.h"
  11:Src/mouse_state.c **** #include "imu.h"
  12:Src/mouse_state.c **** #include "mouse_state.h"
  13:Src/mouse_state.c **** 
  14:Src/mouse_state.c **** static float tire_r_speed = 0;
  15:Src/mouse_state.c **** static float tire_l_speed = 0;
  16:Src/mouse_state.c **** static float tire_r_speed_max = 0;
  17:Src/mouse_state.c **** static float tire_r_speed_min = 0;
  18:Src/mouse_state.c **** static float tire_l_speed_max = 0;
  19:Src/mouse_state.c **** static float tire_l_speed_min = 0; 
  20:Src/mouse_state.c **** static float move_speed = 0;
  21:Src/mouse_state.c **** static float move_speed_ave = 0;
  22:Src/mouse_state.c **** static float move_accel_ave = 0;
  23:Src/mouse_state.c **** static float move_length = 0;
  24:Src/mouse_state.c **** static float rotation_speed = 0;
  25:Src/mouse_state.c **** static float rotation_angle = 0;
  26:Src/mouse_state.c **** 
  27:Src/mouse_state.c **** //機能	: mouse_stateの1msタスクまとめ
  28:Src/mouse_state.c **** //引数	: なし
  29:Src/mouse_state.c **** //返り値	: なし
  30:Src/mouse_state.c **** void mouse_state_1ms ( void )
ARM GAS  C:\Temp\ccj03XTy.s 			page 2


  31:Src/mouse_state.c **** {
  32:Src/mouse_state.c **** //	calc_move_speed();		//速度計算
  33:Src/mouse_state.c **** 	calc_rotation_speed();	//角速度計算
  34:Src/mouse_state.c **** //	filter_move_speed();	//速度をフィルタ処理
  35:Src/mouse_state.c **** 	calc_move_length();		//移動距離を計算
  36:Src/mouse_state.c **** 	calc_rotation_angle();	//回転角度を計算
  37:Src/mouse_state.c **** }
  38:Src/mouse_state.c **** 
  39:Src/mouse_state.c **** //機能	: 右タイヤのエンコーダのカウント差を取得する
  40:Src/mouse_state.c **** //引数	: なし
  41:Src/mouse_state.c **** //返り値	: 右タイヤのエンコーダのカウント差
  42:Src/mouse_state.c **** int16_t Get_diff_right_count( void )
  43:Src/mouse_state.c **** {
  29              		.loc 1 43 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 08B5     		push	{r3, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 8
  36              		.cfi_offset 3, -8
  37              		.cfi_offset 14, -4
  44:Src/mouse_state.c ****     static uint16_t right_count_old = ENC_ZERO;
  38              		.loc 1 44 5 view .LVU1
  45:Src/mouse_state.c ****     uint16_t right_count = 0;
  39              		.loc 1 45 5 view .LVU2
  40              	.LVL0:
  46:Src/mouse_state.c ****     int16_t delta_right_count = 0;
  41              		.loc 1 46 5 view .LVU3
  47:Src/mouse_state.c **** 
  48:Src/mouse_state.c ****     right_count =  get_encordercount_r();
  42              		.loc 1 48 5 view .LVU4
  43              		.loc 1 48 20 is_stmt 0 view .LVU5
  44 0002 FFF7FEFF 		bl	get_encordercount_r
  45              	.LVL1:
  49:Src/mouse_state.c ****     delta_right_count = (int16_t)( right_count - right_count_old);
  46              		.loc 1 49 5 is_stmt 1 view .LVU6
  47              		.loc 1 49 48 is_stmt 0 view .LVU7
  48 0006 034A     		ldr	r2, .L3
  49 0008 1388     		ldrh	r3, [r2]
  50 000a C31A     		subs	r3, r0, r3
  51              	.LVL2:
  50:Src/mouse_state.c **** 
  51:Src/mouse_state.c ****     right_count_old = right_count;//カウンタ更新
  52              		.loc 1 51 5 is_stmt 1 view .LVU8
  53              		.loc 1 51 21 is_stmt 0 view .LVU9
  54 000c 1080     		strh	r0, [r2]	@ movhi
  52:Src/mouse_state.c ****     return delta_right_count;
  55              		.loc 1 52 5 is_stmt 1 view .LVU10
  53:Src/mouse_state.c **** }
  56              		.loc 1 53 1 is_stmt 0 view .LVU11
  57 000e 18B2     		sxth	r0, r3
  58              	.LVL3:
  59              		.loc 1 53 1 view .LVU12
  60 0010 08BD     		pop	{r3, pc}
  61              	.LVL4:
  62              	.L4:
ARM GAS  C:\Temp\ccj03XTy.s 			page 3


  63              		.loc 1 53 1 view .LVU13
  64 0012 00BF     		.align	2
  65              	.L3:
  66 0014 00000000 		.word	.LANCHOR0
  67              		.cfi_endproc
  68              	.LFE4:
  70              		.section	.text.Get_diff_left_count,"ax",%progbits
  71              		.align	1
  72              		.global	Get_diff_left_count
  73              		.syntax unified
  74              		.thumb
  75              		.thumb_func
  76              		.fpu fpv4-sp-d16
  78              	Get_diff_left_count:
  79              	.LFB5:
  54:Src/mouse_state.c **** 
  55:Src/mouse_state.c **** //機能	: 左タイヤのエンコーダのカウント差を取得する
  56:Src/mouse_state.c **** //引数	: なし
  57:Src/mouse_state.c **** //返り値	: 左タイヤのエンコーダのカウント差
  58:Src/mouse_state.c **** int16_t Get_diff_left_count( void )
  59:Src/mouse_state.c **** {
  80              		.loc 1 59 1 is_stmt 1 view -0
  81              		.cfi_startproc
  82              		@ args = 0, pretend = 0, frame = 0
  83              		@ frame_needed = 0, uses_anonymous_args = 0
  84 0000 08B5     		push	{r3, lr}
  85              	.LCFI1:
  86              		.cfi_def_cfa_offset 8
  87              		.cfi_offset 3, -8
  88              		.cfi_offset 14, -4
  60:Src/mouse_state.c ****     static uint16_t left_count_old = ENC_ZERO;
  89              		.loc 1 60 5 view .LVU15
  61:Src/mouse_state.c ****     uint16_t left_count = 0;
  90              		.loc 1 61 5 view .LVU16
  91              	.LVL5:
  62:Src/mouse_state.c ****     int16_t delta_left_count = 0;
  92              		.loc 1 62 5 view .LVU17
  63:Src/mouse_state.c **** 
  64:Src/mouse_state.c ****     left_count =  get_encordercount_l();
  93              		.loc 1 64 5 view .LVU18
  94              		.loc 1 64 19 is_stmt 0 view .LVU19
  95 0002 FFF7FEFF 		bl	get_encordercount_l
  96              	.LVL6:
  65:Src/mouse_state.c ****     delta_left_count = (int16_t)( left_count - left_count_old);
  97              		.loc 1 65 5 is_stmt 1 view .LVU20
  98              		.loc 1 65 46 is_stmt 0 view .LVU21
  99 0006 034A     		ldr	r2, .L7
 100 0008 1388     		ldrh	r3, [r2]
 101 000a C31A     		subs	r3, r0, r3
 102              	.LVL7:
  66:Src/mouse_state.c **** 
  67:Src/mouse_state.c ****     left_count_old = left_count;//カウンタ更新
 103              		.loc 1 67 5 is_stmt 1 view .LVU22
 104              		.loc 1 67 20 is_stmt 0 view .LVU23
 105 000c 1080     		strh	r0, [r2]	@ movhi
  68:Src/mouse_state.c ****     return delta_left_count;
 106              		.loc 1 68 5 is_stmt 1 view .LVU24
ARM GAS  C:\Temp\ccj03XTy.s 			page 4


  69:Src/mouse_state.c **** }
 107              		.loc 1 69 1 is_stmt 0 view .LVU25
 108 000e 18B2     		sxth	r0, r3
 109              	.LVL8:
 110              		.loc 1 69 1 view .LVU26
 111 0010 08BD     		pop	{r3, pc}
 112              	.LVL9:
 113              	.L8:
 114              		.loc 1 69 1 view .LVU27
 115 0012 00BF     		.align	2
 116              	.L7:
 117 0014 00000000 		.word	.LANCHOR1
 118              		.cfi_endproc
 119              	.LFE5:
 121              		.section	.text.calc_move_speed,"ax",%progbits
 122              		.align	1
 123              		.global	calc_move_speed
 124              		.syntax unified
 125              		.thumb
 126              		.thumb_func
 127              		.fpu fpv4-sp-d16
 129              	calc_move_speed:
 130              	.LFB6:
  70:Src/mouse_state.c **** 
  71:Src/mouse_state.c **** //機能	: エンコーダのカウント差から、マウスの速度を算出する
  72:Src/mouse_state.c **** //引数	: なし
  73:Src/mouse_state.c **** //返り値	: タイヤの速度
  74:Src/mouse_state.c **** //備考  : 1msタスク
  75:Src/mouse_state.c **** void calc_move_speed ( void )
  76:Src/mouse_state.c **** {
 131              		.loc 1 76 1 is_stmt 1 view -0
 132              		.cfi_startproc
 133              		@ args = 0, pretend = 0, frame = 0
 134              		@ frame_needed = 0, uses_anonymous_args = 0
 135 0000 08B5     		push	{r3, lr}
 136              	.LCFI2:
 137              		.cfi_def_cfa_offset 8
 138              		.cfi_offset 3, -8
 139              		.cfi_offset 14, -4
 140 0002 2DED028B 		vpush.64	{d8}
 141              	.LCFI3:
 142              		.cfi_def_cfa_offset 16
 143              		.cfi_offset 80, -16
 144              		.cfi_offset 81, -12
  77:Src/mouse_state.c **** 
  78:Src/mouse_state.c ****     float delta_angle_tire_r = 0;
 145              		.loc 1 78 5 view .LVU29
 146              	.LVL10:
  79:Src/mouse_state.c ****     float delta_angle_tire_l = 0;
 147              		.loc 1 79 5 view .LVU30
  80:Src/mouse_state.c ****    
  81:Src/mouse_state.c **** 	/* 各タイヤの角速度計算[rad/s] */
  82:Src/mouse_state.c **** 	delta_angle_tire_r = -1 * 1000 * 2 * PI * (float)Get_diff_right_count() / (float)ENC_RESOLUTION;
 148              		.loc 1 82 2 view .LVU31
 149              		.loc 1 82 51 is_stmt 0 view .LVU32
 150 0006 FFF7FEFF 		bl	Get_diff_right_count
 151              	.LVL11:
ARM GAS  C:\Temp\ccj03XTy.s 			page 5


 152 000a 07EE900A 		vmov	s15, r0	@ int
 153              		.loc 1 82 44 view .LVU33
 154 000e F8EEE77A 		vcvt.f32.s32	s15, s15
 155              		.loc 1 82 42 view .LVU34
 156 0012 9FED2B7A 		vldr.32	s14, .L25
 157 0016 67EE877A 		vmul.f32	s15, s15, s14
 158              		.loc 1 82 21 view .LVU35
 159 001a DFED2A8A 		vldr.32	s17, .L25+4
 160 001e 87EEA88A 		vdiv.f32	s16, s15, s17
 161              	.LVL12:
  83:Src/mouse_state.c **** 	delta_angle_tire_l =  1 * 1000 * 2 * PI * (float)Get_diff_left_count() / (float)ENC_RESOLUTION;
 162              		.loc 1 83 2 is_stmt 1 view .LVU36
 163              		.loc 1 83 51 is_stmt 0 view .LVU37
 164 0022 FFF7FEFF 		bl	Get_diff_left_count
 165              	.LVL13:
 166 0026 07EE900A 		vmov	s15, r0	@ int
 167              		.loc 1 83 44 view .LVU38
 168 002a F8EEE77A 		vcvt.f32.s32	s15, s15
 169              		.loc 1 83 42 view .LVU39
 170 002e 9FED267A 		vldr.32	s14, .L25+8
 171 0032 67EE877A 		vmul.f32	s15, s15, s14
 172              		.loc 1 83 21 view .LVU40
 173 0036 87EEA87A 		vdiv.f32	s14, s15, s17
 174              	.LVL14:
  84:Src/mouse_state.c **** 
  85:Src/mouse_state.c **** 	/*各タイヤの速度計算[m/s]*/
  86:Src/mouse_state.c **** 	tire_r_speed = Tire_diameter * 0.5 * delta_angle_tire_r;
 175              		.loc 1 86 2 is_stmt 1 view .LVU41
 176              		.loc 1 86 15 is_stmt 0 view .LVU42
 177 003a DFED246A 		vldr.32	s13, .L25+12
 178 003e 68EE267A 		vmul.f32	s15, s16, s13
 179 0042 234B     		ldr	r3, .L25+16
 180 0044 C3ED007A 		vstr.32	s15, [r3]
  87:Src/mouse_state.c **** 	tire_l_speed = Tire_diameter * 0.5 * delta_angle_tire_l;
 181              		.loc 1 87 2 is_stmt 1 view .LVU43
 182              		.loc 1 87 15 is_stmt 0 view .LVU44
 183 0048 27EE267A 		vmul.f32	s14, s14, s13
 184              	.LVL15:
 185              		.loc 1 87 15 view .LVU45
 186 004c 214B     		ldr	r3, .L25+20
 187 004e 83ED007A 		vstr.32	s14, [r3]
  88:Src/mouse_state.c **** 
  89:Src/mouse_state.c ****     /*各タイヤの最大、最小速度更新*/
  90:Src/mouse_state.c ****     //右
  91:Src/mouse_state.c ****     if(tire_r_speed > tire_r_speed_max)
 188              		.loc 1 91 5 is_stmt 1 view .LVU46
 189              		.loc 1 91 21 is_stmt 0 view .LVU47
 190 0052 214B     		ldr	r3, .L25+24
 191 0054 D3ED006A 		vldr.32	s13, [r3]
 192              		.loc 1 91 7 view .LVU48
 193 0058 F4EEE67A 		vcmpe.f32	s15, s13
 194 005c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 195 0060 17DD     		ble	.L22
  92:Src/mouse_state.c **** 	{   
  93:Src/mouse_state.c **** 		tire_r_speed_max = tire_r_speed;
 196              		.loc 1 93 3 is_stmt 1 view .LVU49
 197              		.loc 1 93 20 is_stmt 0 view .LVU50
ARM GAS  C:\Temp\ccj03XTy.s 			page 6


 198 0062 C3ED007A 		vstr.32	s15, [r3]
 199              	.L12:
  94:Src/mouse_state.c **** 	}
  95:Src/mouse_state.c **** 	else if(tire_r_speed < tire_r_speed_min)
  96:Src/mouse_state.c **** 	{
  97:Src/mouse_state.c **** 		tire_r_speed_min = tire_r_speed;
  98:Src/mouse_state.c **** 	}
  99:Src/mouse_state.c ****     //左
 100:Src/mouse_state.c **** 	if(tire_l_speed > tire_l_speed_max)
 200              		.loc 1 100 2 is_stmt 1 view .LVU51
 201              		.loc 1 100 18 is_stmt 0 view .LVU52
 202 0066 1D4B     		ldr	r3, .L25+28
 203 0068 D3ED006A 		vldr.32	s13, [r3]
 204              		.loc 1 100 4 view .LVU53
 205 006c B4EEE67A 		vcmpe.f32	s14, s13
 206 0070 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 207 0074 18DD     		ble	.L23
 101:Src/mouse_state.c **** 	{
 102:Src/mouse_state.c **** 		tire_l_speed_max = tire_l_speed;
 208              		.loc 1 102 3 is_stmt 1 view .LVU54
 209              		.loc 1 102 20 is_stmt 0 view .LVU55
 210 0076 83ED007A 		vstr.32	s14, [r3]
 211              	.L16:
 103:Src/mouse_state.c **** 	}
 104:Src/mouse_state.c **** 	else if(tire_l_speed < tire_l_speed_min)
 105:Src/mouse_state.c **** 	{
 106:Src/mouse_state.c **** 		tire_l_speed_min = tire_l_speed;
 107:Src/mouse_state.c **** 	}
 108:Src/mouse_state.c **** 
 109:Src/mouse_state.c ****     /*マウスの速度計算[m/s]*/
 110:Src/mouse_state.c ****     move_speed = (tire_r_speed + tire_l_speed)/2;
 212              		.loc 1 110 5 is_stmt 1 view .LVU56
 213              		.loc 1 110 32 is_stmt 0 view .LVU57
 214 007a 77EE877A 		vadd.f32	s15, s15, s14
 215              		.loc 1 110 47 view .LVU58
 216 007e B6EE007A 		vmov.f32	s14, #5.0e-1
 217 0082 67EE877A 		vmul.f32	s15, s15, s14
 218              		.loc 1 110 16 view .LVU59
 219 0086 164B     		ldr	r3, .L25+32
 220 0088 C3ED007A 		vstr.32	s15, [r3]
 111:Src/mouse_state.c **** 
 112:Src/mouse_state.c **** }
 221              		.loc 1 112 1 view .LVU60
 222 008c BDEC028B 		vldm	sp!, {d8}
 223              	.LCFI4:
 224              		.cfi_remember_state
 225              		.cfi_restore 80
 226              		.cfi_restore 81
 227              		.cfi_def_cfa_offset 8
 228              	.LVL16:
 229              		.loc 1 112 1 view .LVU61
 230 0090 08BD     		pop	{r3, pc}
 231              	.LVL17:
 232              	.L22:
 233              	.LCFI5:
 234              		.cfi_restore_state
  95:Src/mouse_state.c **** 	{
ARM GAS  C:\Temp\ccj03XTy.s 			page 7


 235              		.loc 1 95 7 is_stmt 1 view .LVU62
  95:Src/mouse_state.c **** 	{
 236              		.loc 1 95 23 is_stmt 0 view .LVU63
 237 0092 144B     		ldr	r3, .L25+36
 238 0094 D3ED006A 		vldr.32	s13, [r3]
  95:Src/mouse_state.c **** 	{
 239              		.loc 1 95 9 view .LVU64
 240 0098 F4EEE67A 		vcmpe.f32	s15, s13
 241 009c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 242 00a0 E1D5     		bpl	.L12
  97:Src/mouse_state.c **** 	}
 243              		.loc 1 97 3 is_stmt 1 view .LVU65
  97:Src/mouse_state.c **** 	}
 244              		.loc 1 97 20 is_stmt 0 view .LVU66
 245 00a2 C3ED007A 		vstr.32	s15, [r3]
 246 00a6 DEE7     		b	.L12
 247              	.L23:
 104:Src/mouse_state.c **** 	{
 248              		.loc 1 104 7 is_stmt 1 view .LVU67
 104:Src/mouse_state.c **** 	{
 249              		.loc 1 104 23 is_stmt 0 view .LVU68
 250 00a8 0F4B     		ldr	r3, .L25+40
 251 00aa D3ED006A 		vldr.32	s13, [r3]
 104:Src/mouse_state.c **** 	{
 252              		.loc 1 104 9 view .LVU69
 253 00ae B4EEE67A 		vcmpe.f32	s14, s13
 254 00b2 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 255 00b6 E0D5     		bpl	.L16
 106:Src/mouse_state.c **** 	}
 256              		.loc 1 106 3 is_stmt 1 view .LVU70
 106:Src/mouse_state.c **** 	}
 257              		.loc 1 106 20 is_stmt 0 view .LVU71
 258 00b8 83ED007A 		vstr.32	s14, [r3]
 259 00bc DDE7     		b	.L16
 260              	.L26:
 261 00be 00BF     		.align	2
 262              	.L25:
 263 00c0 7B59C4C5 		.word	-976987781
 264 00c4 00C07F44 		.word	1149222912
 265 00c8 7B59C445 		.word	1170495867
 266 00cc 2A89CF3B 		.word	1003456810
 267 00d0 00000000 		.word	.LANCHOR2
 268 00d4 00000000 		.word	.LANCHOR3
 269 00d8 00000000 		.word	.LANCHOR4
 270 00dc 00000000 		.word	.LANCHOR6
 271 00e0 00000000 		.word	.LANCHOR8
 272 00e4 00000000 		.word	.LANCHOR5
 273 00e8 00000000 		.word	.LANCHOR7
 274              		.cfi_endproc
 275              	.LFE6:
 277              		.section	.text.get_tire_r_speed,"ax",%progbits
 278              		.align	1
 279              		.global	get_tire_r_speed
 280              		.syntax unified
 281              		.thumb
 282              		.thumb_func
 283              		.fpu fpv4-sp-d16
ARM GAS  C:\Temp\ccj03XTy.s 			page 8


 285              	get_tire_r_speed:
 286              	.LFB7:
 113:Src/mouse_state.c **** 
 114:Src/mouse_state.c **** //機能	: 右タイヤの速度[m/s]を取得する
 115:Src/mouse_state.c **** //引数	: なし
 116:Src/mouse_state.c **** //返り値	: 右タイヤの移動速度[m/s]
 117:Src/mouse_state.c **** float get_tire_r_speed ( void )
 118:Src/mouse_state.c **** {
 287              		.loc 1 118 1 is_stmt 1 view -0
 288              		.cfi_startproc
 289              		@ args = 0, pretend = 0, frame = 0
 290              		@ frame_needed = 0, uses_anonymous_args = 0
 291              		@ link register save eliminated.
 119:Src/mouse_state.c ****     return tire_r_speed;
 292              		.loc 1 119 5 view .LVU73
 120:Src/mouse_state.c **** }
 293              		.loc 1 120 1 is_stmt 0 view .LVU74
 294 0000 014B     		ldr	r3, .L28
 295 0002 93ED000A 		vldr.32	s0, [r3]
 296 0006 7047     		bx	lr
 297              	.L29:
 298              		.align	2
 299              	.L28:
 300 0008 00000000 		.word	.LANCHOR2
 301              		.cfi_endproc
 302              	.LFE7:
 304              		.section	.text.get_tire_r_speed_max,"ax",%progbits
 305              		.align	1
 306              		.global	get_tire_r_speed_max
 307              		.syntax unified
 308              		.thumb
 309              		.thumb_func
 310              		.fpu fpv4-sp-d16
 312              	get_tire_r_speed_max:
 313              	.LFB8:
 121:Src/mouse_state.c **** 
 122:Src/mouse_state.c **** //機能	: 右タイヤの最大速度[m/s]を取得する
 123:Src/mouse_state.c **** //引数	: なし
 124:Src/mouse_state.c **** //返り値	: 右タイヤの最大速度[m/s]
 125:Src/mouse_state.c **** float get_tire_r_speed_max ( void )
 126:Src/mouse_state.c **** {
 314              		.loc 1 126 1 is_stmt 1 view -0
 315              		.cfi_startproc
 316              		@ args = 0, pretend = 0, frame = 0
 317              		@ frame_needed = 0, uses_anonymous_args = 0
 318              		@ link register save eliminated.
 127:Src/mouse_state.c ****     return tire_r_speed_max;
 319              		.loc 1 127 5 view .LVU76
 128:Src/mouse_state.c **** }
 320              		.loc 1 128 1 is_stmt 0 view .LVU77
 321 0000 014B     		ldr	r3, .L31
 322 0002 93ED000A 		vldr.32	s0, [r3]
 323 0006 7047     		bx	lr
 324              	.L32:
 325              		.align	2
 326              	.L31:
 327 0008 00000000 		.word	.LANCHOR4
ARM GAS  C:\Temp\ccj03XTy.s 			page 9


 328              		.cfi_endproc
 329              	.LFE8:
 331              		.section	.text.get_tire_r_speed_min,"ax",%progbits
 332              		.align	1
 333              		.global	get_tire_r_speed_min
 334              		.syntax unified
 335              		.thumb
 336              		.thumb_func
 337              		.fpu fpv4-sp-d16
 339              	get_tire_r_speed_min:
 340              	.LFB9:
 129:Src/mouse_state.c **** 
 130:Src/mouse_state.c **** //機能	: 右タイヤの最低速度[m/s]を取得する
 131:Src/mouse_state.c **** //引数	: なし
 132:Src/mouse_state.c **** //返り値	: 右タイヤの最低速度[m/s]
 133:Src/mouse_state.c **** float get_tire_r_speed_min ( void )
 134:Src/mouse_state.c **** {
 341              		.loc 1 134 1 is_stmt 1 view -0
 342              		.cfi_startproc
 343              		@ args = 0, pretend = 0, frame = 0
 344              		@ frame_needed = 0, uses_anonymous_args = 0
 345              		@ link register save eliminated.
 135:Src/mouse_state.c ****     return tire_r_speed_min;
 346              		.loc 1 135 5 view .LVU79
 136:Src/mouse_state.c **** }
 347              		.loc 1 136 1 is_stmt 0 view .LVU80
 348 0000 014B     		ldr	r3, .L34
 349 0002 93ED000A 		vldr.32	s0, [r3]
 350 0006 7047     		bx	lr
 351              	.L35:
 352              		.align	2
 353              	.L34:
 354 0008 00000000 		.word	.LANCHOR5
 355              		.cfi_endproc
 356              	.LFE9:
 358              		.section	.text.get_tire_l_speed,"ax",%progbits
 359              		.align	1
 360              		.global	get_tire_l_speed
 361              		.syntax unified
 362              		.thumb
 363              		.thumb_func
 364              		.fpu fpv4-sp-d16
 366              	get_tire_l_speed:
 367              	.LFB10:
 137:Src/mouse_state.c **** 
 138:Src/mouse_state.c **** //機能	: 左タイヤの速度[m/s]を取得する
 139:Src/mouse_state.c **** //引数	: なし
 140:Src/mouse_state.c **** //返り値	: 左タイヤの速度[m/s]
 141:Src/mouse_state.c **** float get_tire_l_speed ( void )
 142:Src/mouse_state.c **** {
 368              		.loc 1 142 1 is_stmt 1 view -0
 369              		.cfi_startproc
 370              		@ args = 0, pretend = 0, frame = 0
 371              		@ frame_needed = 0, uses_anonymous_args = 0
 372              		@ link register save eliminated.
 143:Src/mouse_state.c ****     return tire_l_speed;
 373              		.loc 1 143 5 view .LVU82
ARM GAS  C:\Temp\ccj03XTy.s 			page 10


 144:Src/mouse_state.c **** }
 374              		.loc 1 144 1 is_stmt 0 view .LVU83
 375 0000 014B     		ldr	r3, .L37
 376 0002 93ED000A 		vldr.32	s0, [r3]
 377 0006 7047     		bx	lr
 378              	.L38:
 379              		.align	2
 380              	.L37:
 381 0008 00000000 		.word	.LANCHOR3
 382              		.cfi_endproc
 383              	.LFE10:
 385              		.section	.text.get_tire_l_speed_max,"ax",%progbits
 386              		.align	1
 387              		.global	get_tire_l_speed_max
 388              		.syntax unified
 389              		.thumb
 390              		.thumb_func
 391              		.fpu fpv4-sp-d16
 393              	get_tire_l_speed_max:
 394              	.LFB11:
 145:Src/mouse_state.c **** 
 146:Src/mouse_state.c **** //機能	: 左タイヤの最大速度[m/s]を取得する
 147:Src/mouse_state.c **** //引数	: なし
 148:Src/mouse_state.c **** //返り値	: 左タイヤの最大速度[m/s]
 149:Src/mouse_state.c **** float get_tire_l_speed_max ( void )
 150:Src/mouse_state.c **** {
 395              		.loc 1 150 1 is_stmt 1 view -0
 396              		.cfi_startproc
 397              		@ args = 0, pretend = 0, frame = 0
 398              		@ frame_needed = 0, uses_anonymous_args = 0
 399              		@ link register save eliminated.
 151:Src/mouse_state.c ****     return tire_l_speed_max;
 400              		.loc 1 151 5 view .LVU85
 152:Src/mouse_state.c **** }
 401              		.loc 1 152 1 is_stmt 0 view .LVU86
 402 0000 014B     		ldr	r3, .L40
 403 0002 93ED000A 		vldr.32	s0, [r3]
 404 0006 7047     		bx	lr
 405              	.L41:
 406              		.align	2
 407              	.L40:
 408 0008 00000000 		.word	.LANCHOR6
 409              		.cfi_endproc
 410              	.LFE11:
 412              		.section	.text.get_tire_l_speed_min,"ax",%progbits
 413              		.align	1
 414              		.global	get_tire_l_speed_min
 415              		.syntax unified
 416              		.thumb
 417              		.thumb_func
 418              		.fpu fpv4-sp-d16
 420              	get_tire_l_speed_min:
 421              	.LFB12:
 153:Src/mouse_state.c **** 
 154:Src/mouse_state.c **** //機能	: 左タイヤの最低速度[m/s]を取得する
 155:Src/mouse_state.c **** //引数	: なし
 156:Src/mouse_state.c **** //返り値	: 左タイヤの最低速度[m/s]
ARM GAS  C:\Temp\ccj03XTy.s 			page 11


 157:Src/mouse_state.c **** float get_tire_l_speed_min ( void )
 158:Src/mouse_state.c **** {
 422              		.loc 1 158 1 is_stmt 1 view -0
 423              		.cfi_startproc
 424              		@ args = 0, pretend = 0, frame = 0
 425              		@ frame_needed = 0, uses_anonymous_args = 0
 426              		@ link register save eliminated.
 159:Src/mouse_state.c ****     return tire_l_speed_min;
 427              		.loc 1 159 5 view .LVU88
 160:Src/mouse_state.c **** }
 428              		.loc 1 160 1 is_stmt 0 view .LVU89
 429 0000 014B     		ldr	r3, .L43
 430 0002 93ED000A 		vldr.32	s0, [r3]
 431 0006 7047     		bx	lr
 432              	.L44:
 433              		.align	2
 434              	.L43:
 435 0008 00000000 		.word	.LANCHOR7
 436              		.cfi_endproc
 437              	.LFE12:
 439              		.section	.text.init_tire_speed,"ax",%progbits
 440              		.align	1
 441              		.global	init_tire_speed
 442              		.syntax unified
 443              		.thumb
 444              		.thumb_func
 445              		.fpu fpv4-sp-d16
 447              	init_tire_speed:
 448              	.LFB13:
 161:Src/mouse_state.c **** 
 162:Src/mouse_state.c **** //機能	: 各タイヤの最大、最低速度を初期化する
 163:Src/mouse_state.c **** //引数	: なし
 164:Src/mouse_state.c **** //返り値	: なし
 165:Src/mouse_state.c **** void init_tire_speed ( void )
 166:Src/mouse_state.c **** {
 449              		.loc 1 166 1 is_stmt 1 view -0
 450              		.cfi_startproc
 451              		@ args = 0, pretend = 0, frame = 0
 452              		@ frame_needed = 0, uses_anonymous_args = 0
 453              		@ link register save eliminated.
 167:Src/mouse_state.c ****     tire_r_speed_min = 0;
 454              		.loc 1 167 5 view .LVU91
 455              		.loc 1 167 22 is_stmt 0 view .LVU92
 456 0000 0023     		movs	r3, #0
 457 0002 044A     		ldr	r2, .L46
 458 0004 1360     		str	r3, [r2]	@ float
 168:Src/mouse_state.c ****     tire_r_speed_max = 0;
 459              		.loc 1 168 5 is_stmt 1 view .LVU93
 460              		.loc 1 168 22 is_stmt 0 view .LVU94
 461 0006 044A     		ldr	r2, .L46+4
 462 0008 1360     		str	r3, [r2]	@ float
 169:Src/mouse_state.c ****     tire_l_speed_min = 0;
 463              		.loc 1 169 5 is_stmt 1 view .LVU95
 464              		.loc 1 169 22 is_stmt 0 view .LVU96
 465 000a 044A     		ldr	r2, .L46+8
 466 000c 1360     		str	r3, [r2]	@ float
 170:Src/mouse_state.c ****     tire_l_speed_max = 0;
ARM GAS  C:\Temp\ccj03XTy.s 			page 12


 467              		.loc 1 170 5 is_stmt 1 view .LVU97
 468              		.loc 1 170 22 is_stmt 0 view .LVU98
 469 000e 044A     		ldr	r2, .L46+12
 470 0010 1360     		str	r3, [r2]	@ float
 171:Src/mouse_state.c **** 
 172:Src/mouse_state.c **** }
 471              		.loc 1 172 1 view .LVU99
 472 0012 7047     		bx	lr
 473              	.L47:
 474              		.align	2
 475              	.L46:
 476 0014 00000000 		.word	.LANCHOR5
 477 0018 00000000 		.word	.LANCHOR4
 478 001c 00000000 		.word	.LANCHOR7
 479 0020 00000000 		.word	.LANCHOR6
 480              		.cfi_endproc
 481              	.LFE13:
 483              		.section	.text.get_move_speed,"ax",%progbits
 484              		.align	1
 485              		.global	get_move_speed
 486              		.syntax unified
 487              		.thumb
 488              		.thumb_func
 489              		.fpu fpv4-sp-d16
 491              	get_move_speed:
 492              	.LFB14:
 173:Src/mouse_state.c **** 
 174:Src/mouse_state.c **** //機能	: マウスの移動速度[m/s]を取得する
 175:Src/mouse_state.c **** //引数	: なし
 176:Src/mouse_state.c **** //返り値	: マウスの移動速度
 177:Src/mouse_state.c **** float get_move_speed ( void )
 178:Src/mouse_state.c **** {
 493              		.loc 1 178 1 is_stmt 1 view -0
 494              		.cfi_startproc
 495              		@ args = 0, pretend = 0, frame = 0
 496              		@ frame_needed = 0, uses_anonymous_args = 0
 497              		@ link register save eliminated.
 179:Src/mouse_state.c ****     return move_speed;
 498              		.loc 1 179 5 view .LVU101
 180:Src/mouse_state.c **** }
 499              		.loc 1 180 1 is_stmt 0 view .LVU102
 500 0000 014B     		ldr	r3, .L49
 501 0002 93ED000A 		vldr.32	s0, [r3]
 502 0006 7047     		bx	lr
 503              	.L50:
 504              		.align	2
 505              	.L49:
 506 0008 00000000 		.word	.LANCHOR8
 507              		.cfi_endproc
 508              	.LFE14:
 510              		.global	__aeabi_f2d
 511              		.global	__aeabi_dmul
 512              		.global	__aeabi_dadd
 513              		.global	__aeabi_d2f
 514              		.section	.text.filter_move_speed,"ax",%progbits
 515              		.align	1
 516              		.global	filter_move_speed
ARM GAS  C:\Temp\ccj03XTy.s 			page 13


 517              		.syntax unified
 518              		.thumb
 519              		.thumb_func
 520              		.fpu fpv4-sp-d16
 522              	filter_move_speed:
 523              	.LFB15:
 181:Src/mouse_state.c **** 
 182:Src/mouse_state.c **** //機能	: マウスの速度に移動平均フィルタをかける。
 183:Src/mouse_state.c **** //引数	: なし
 184:Src/mouse_state.c **** //返り値	: なし
 185:Src/mouse_state.c **** //備考  : ジャイロの加速度を用いて、遅れを補完する。
 186:Src/mouse_state.c **** //      : 1msタスク 
 187:Src/mouse_state.c **** void filter_move_speed( void )
 188:Src/mouse_state.c **** {
 524              		.loc 1 188 1 is_stmt 1 view -0
 525              		.cfi_startproc
 526              		@ args = 0, pretend = 0, frame = 0
 527              		@ frame_needed = 0, uses_anonymous_args = 0
 528 0000 38B5     		push	{r3, r4, r5, lr}
 529              	.LCFI6:
 530              		.cfi_def_cfa_offset 16
 531              		.cfi_offset 3, -16
 532              		.cfi_offset 4, -12
 533              		.cfi_offset 5, -8
 534              		.cfi_offset 14, -4
 535 0002 2DED028B 		vpush.64	{d8}
 536              	.LCFI7:
 537              		.cfi_def_cfa_offset 24
 538              		.cfi_offset 80, -24
 539              		.cfi_offset 81, -20
 189:Src/mouse_state.c ****     typedef struct {
 540              		.loc 1 189 5 view .LVU104
 190:Src/mouse_state.c **** 	float	speed;			
 191:Src/mouse_state.c **** 	float   accel;			
 192:Src/mouse_state.c ****     } ave_temp;
 193:Src/mouse_state.c **** 
 194:Src/mouse_state.c ****     static ave_temp ave_store[ave_num];  // データ格納用の構造体
 541              		.loc 1 194 5 view .LVU105
 195:Src/mouse_state.c **** 
 196:Src/mouse_state.c **** 	static uint16_t ave_counter = 0;
 542              		.loc 1 196 2 view .LVU106
 197:Src/mouse_state.c **** 	uint16_t i = 0;
 543              		.loc 1 197 2 view .LVU107
 544              	.LVL18:
 198:Src/mouse_state.c **** 	uint16_t j = 0;
 545              		.loc 1 198 2 view .LVU108
 199:Src/mouse_state.c **** 
 200:Src/mouse_state.c **** 	float speed_ave = 0;	//並進方向速度平均
 546              		.loc 1 200 2 view .LVU109
 201:Src/mouse_state.c **** 	float accel_ave = 0;	//並進方向加速度平均
 547              		.loc 1 201 2 view .LVU110
 202:Src/mouse_state.c **** 
 203:Src/mouse_state.c **** 	float speed_sum = 0; 	//並進方向速度合計
 548              		.loc 1 203 2 view .LVU111
 204:Src/mouse_state.c **** 	float accel_sum = 0;	//並進方向加速度合計
 549              		.loc 1 204 2 view .LVU112
 205:Src/mouse_state.c **** 
ARM GAS  C:\Temp\ccj03XTy.s 			page 14


 206:Src/mouse_state.c **** 	i = ave_counter % ave_num;
 550              		.loc 1 206 2 view .LVU113
 551              		.loc 1 206 4 is_stmt 0 view .LVU114
 552 0006 3A4B     		ldr	r3, .L64+8
 553 0008 1A88     		ldrh	r2, [r3]
 554 000a 3A4B     		ldr	r3, .L64+12
 555 000c A3FB0213 		umull	r1, r3, r3, r2
 556 0010 DB08     		lsrs	r3, r3, #3
 557 0012 03EB8303 		add	r3, r3, r3, lsl #2
 558 0016 A2EB4303 		sub	r3, r2, r3, lsl #1
 559 001a 9CB2     		uxth	r4, r3
 560              	.LVL19:
 207:Src/mouse_state.c **** 	ave_store[i].speed = get_move_speed();
 561              		.loc 1 207 2 is_stmt 1 view .LVU115
 562              		.loc 1 207 23 is_stmt 0 view .LVU116
 563 001c FFF7FEFF 		bl	get_move_speed
 564              	.LVL20:
 565              		.loc 1 207 21 view .LVU117
 566 0020 354A     		ldr	r2, .L64+16
 567 0022 02EBC404 		add	r4, r2, r4, lsl #3
 568              	.LVL21:
 569              		.loc 1 207 21 view .LVU118
 570 0026 84ED000A 		vstr.32	s0, [r4]
 208:Src/mouse_state.c **** 	ave_store[i].accel = IMU_GetAccel_X();
 571              		.loc 1 208 2 is_stmt 1 view .LVU119
 572              		.loc 1 208 23 is_stmt 0 view .LVU120
 573 002a FFF7FEFF 		bl	IMU_GetAccel_X
 574              	.LVL22:
 575              		.loc 1 208 21 view .LVU121
 576 002e 84ED010A 		vstr.32	s0, [r4, #4]
 209:Src/mouse_state.c **** 
 210:Src/mouse_state.c ****     /*移動平均処理*/
 211:Src/mouse_state.c **** 	for(j=0; j < ave_num; j++)
 577              		.loc 1 211 2 is_stmt 1 view .LVU122
 204:Src/mouse_state.c **** 
 578              		.loc 1 204 8 is_stmt 0 view .LVU123
 579 0032 DFED327A 		vldr.32	s15, .L64+20
 203:Src/mouse_state.c **** 	float accel_sum = 0;	//並進方向加速度合計
 580              		.loc 1 203 8 view .LVU124
 581 0036 B0EE677A 		vmov.f32	s14, s15
 582              		.loc 1 211 7 view .LVU125
 583 003a 0023     		movs	r3, #0
 584              	.LVL23:
 585              	.L52:
 586              		.loc 1 211 11 is_stmt 1 discriminator 1 view .LVU126
 587              		.loc 1 211 2 is_stmt 0 discriminator 1 view .LVU127
 588 003c 092B     		cmp	r3, #9
 589 003e 0DD8     		bhi	.L62
 212:Src/mouse_state.c **** 	{
 213:Src/mouse_state.c **** 		speed_sum += ave_store[j].speed;
 590              		.loc 1 213 3 is_stmt 1 discriminator 3 view .LVU128
 591              		.loc 1 213 28 is_stmt 0 discriminator 3 view .LVU129
 592 0040 2D4A     		ldr	r2, .L64+16
 593 0042 02EBC302 		add	r2, r2, r3, lsl #3
 594 0046 D2ED006A 		vldr.32	s13, [r2]
 595              		.loc 1 213 13 discriminator 3 view .LVU130
 596 004a 37EE267A 		vadd.f32	s14, s14, s13
ARM GAS  C:\Temp\ccj03XTy.s 			page 15


 597              	.LVL24:
 214:Src/mouse_state.c **** 		accel_sum += ave_store[j].accel;
 598              		.loc 1 214 3 is_stmt 1 discriminator 3 view .LVU131
 599              		.loc 1 214 28 is_stmt 0 discriminator 3 view .LVU132
 600 004e D2ED016A 		vldr.32	s13, [r2, #4]
 601              		.loc 1 214 13 discriminator 3 view .LVU133
 602 0052 77EEA67A 		vadd.f32	s15, s15, s13
 603              	.LVL25:
 211:Src/mouse_state.c **** 	{
 604              		.loc 1 211 24 is_stmt 1 discriminator 3 view .LVU134
 211:Src/mouse_state.c **** 	{
 605              		.loc 1 211 25 is_stmt 0 discriminator 3 view .LVU135
 606 0056 0133     		adds	r3, r3, #1
 607              	.LVL26:
 211:Src/mouse_state.c **** 	{
 608              		.loc 1 211 25 discriminator 3 view .LVU136
 609 0058 9BB2     		uxth	r3, r3
 610              	.LVL27:
 211:Src/mouse_state.c **** 	{
 611              		.loc 1 211 25 discriminator 3 view .LVU137
 612 005a EFE7     		b	.L52
 613              	.L62:
 215:Src/mouse_state.c **** 	}
 216:Src/mouse_state.c **** 
 217:Src/mouse_state.c **** 	speed_ave = speed_sum / ave_num;
 614              		.loc 1 217 2 is_stmt 1 view .LVU138
 615              		.loc 1 217 12 is_stmt 0 view .LVU139
 616 005c F2EE046A 		vmov.f32	s13, #1.0e+1
 617 0060 C7EE268A 		vdiv.f32	s17, s14, s13
 618              	.LVL28:
 218:Src/mouse_state.c **** 	accel_ave = accel_sum / ave_num;
 619              		.loc 1 218 2 is_stmt 1 view .LVU140
 620              		.loc 1 218 12 is_stmt 0 view .LVU141
 621 0064 87EEA68A 		vdiv.f32	s16, s15, s13
 622              	.LVL29:
 219:Src/mouse_state.c **** 
 220:Src/mouse_state.c **** 	/*加速度センサのぶれを補正、閾値範囲内を０とする*/
 221:Src/mouse_state.c **** 	if(ABS(accel_ave) < 0.5)
 623              		.loc 1 221 2 is_stmt 1 view .LVU142
 624              		.loc 1 221 20 is_stmt 0 view .LVU143
 625 0068 B5EEC08A 		vcmpe.f32	s16, #0
 626 006c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 627 0070 30D4     		bmi	.L63
 628              		.loc 1 221 20 discriminator 2 view .LVU144
 629 0072 F6EE007A 		vmov.f32	s15, #5.0e-1
 630              	.LVL30:
 631              		.loc 1 221 20 discriminator 2 view .LVU145
 632 0076 B4EEE78A 		vcmpe.f32	s16, s15
 633 007a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 634 007e 4CBF     		ite	mi
 635 0080 0123     		movmi	r3, #1
 636              	.LVL31:
 637              		.loc 1 221 20 discriminator 2 view .LVU146
 638 0082 0023     		movpl	r3, #0
 639              	.L56:
 640              		.loc 1 221 4 discriminator 4 view .LVU147
 641 0084 0BB1     		cbz	r3, .L57
ARM GAS  C:\Temp\ccj03XTy.s 			page 16


 222:Src/mouse_state.c **** 	{
 223:Src/mouse_state.c **** 		accel_ave = 0;
 642              		.loc 1 223 13 view .LVU148
 643 0086 9FED1D8A 		vldr.32	s16, .L64+20
 644              	.LVL32:
 645              	.L57:
 224:Src/mouse_state.c **** 	}
 225:Src/mouse_state.c **** 
 226:Src/mouse_state.c **** 	/*遅れ補正*/
 227:Src/mouse_state.c ****     //平均速度＋0.5(加速度平均[m/s2]・平均時間[s])
 228:Src/mouse_state.c **** 	speed_ave += 0.5 * ( accel_ave * (ave_num * 0.001)); 
 646              		.loc 1 228 2 is_stmt 1 view .LVU149
 647              		.loc 1 228 33 is_stmt 0 view .LVU150
 648 008a 18EE100A 		vmov	r0, s16
 649 008e FFF7FEFF 		bl	__aeabi_f2d
 650              	.LVL33:
 651              		.loc 1 228 33 view .LVU151
 652 0092 15A3     		adr	r3, .L64
 653 0094 D3E90023 		ldrd	r2, [r3]
 654 0098 FFF7FEFF 		bl	__aeabi_dmul
 655              	.LVL34:
 656              		.loc 1 228 19 view .LVU152
 657 009c 0022     		movs	r2, #0
 658 009e 184B     		ldr	r3, .L64+24
 659 00a0 FFF7FEFF 		bl	__aeabi_dmul
 660              	.LVL35:
 661 00a4 0446     		mov	r4, r0
 662 00a6 0D46     		mov	r5, r1
 663              		.loc 1 228 12 view .LVU153
 664 00a8 18EE900A 		vmov	r0, s17
 665 00ac FFF7FEFF 		bl	__aeabi_f2d
 666              	.LVL36:
 667 00b0 2246     		mov	r2, r4
 668 00b2 2B46     		mov	r3, r5
 669 00b4 FFF7FEFF 		bl	__aeabi_dadd
 670              	.LVL37:
 671 00b8 FFF7FEFF 		bl	__aeabi_d2f
 672              	.LVL38:
 229:Src/mouse_state.c **** 
 230:Src/mouse_state.c **** 	move_speed_ave = speed_ave;
 673              		.loc 1 230 2 is_stmt 1 view .LVU154
 674              		.loc 1 230 17 is_stmt 0 view .LVU155
 675 00bc 114B     		ldr	r3, .L64+28
 676 00be 1860     		str	r0, [r3]	@ float
 231:Src/mouse_state.c **** 	move_accel_ave = accel_ave;
 677              		.loc 1 231 2 is_stmt 1 view .LVU156
 678              		.loc 1 231 17 is_stmt 0 view .LVU157
 679 00c0 114B     		ldr	r3, .L64+32
 680 00c2 83ED008A 		vstr.32	s16, [r3]
 232:Src/mouse_state.c **** 
 233:Src/mouse_state.c **** 	ave_counter += 1 ;
 681              		.loc 1 233 2 is_stmt 1 view .LVU158
 682              		.loc 1 233 14 is_stmt 0 view .LVU159
 683 00c6 0A4A     		ldr	r2, .L64+8
 684 00c8 1388     		ldrh	r3, [r2]
 685 00ca 0133     		adds	r3, r3, #1
 686 00cc 1380     		strh	r3, [r2]	@ movhi
ARM GAS  C:\Temp\ccj03XTy.s 			page 17


 234:Src/mouse_state.c **** }
 687              		.loc 1 234 1 view .LVU160
 688 00ce BDEC028B 		vldm	sp!, {d8}
 689              	.LCFI8:
 690              		.cfi_remember_state
 691              		.cfi_restore 80
 692              		.cfi_restore 81
 693              		.cfi_def_cfa_offset 16
 694              	.LVL39:
 695              		.loc 1 234 1 view .LVU161
 696 00d2 38BD     		pop	{r3, r4, r5, pc}
 697              	.LVL40:
 698              	.L63:
 699              	.LCFI9:
 700              		.cfi_restore_state
 221:Src/mouse_state.c **** 	{
 701              		.loc 1 221 20 discriminator 1 view .LVU162
 702 00d4 FEEE007A 		vmov.f32	s15, #-5.0e-1
 703              	.LVL41:
 221:Src/mouse_state.c **** 	{
 704              		.loc 1 221 20 discriminator 1 view .LVU163
 705 00d8 B4EEE78A 		vcmpe.f32	s16, s15
 706 00dc F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 707 00e0 CCBF     		ite	gt
 708 00e2 0123     		movgt	r3, #1
 709              	.LVL42:
 221:Src/mouse_state.c **** 	{
 710              		.loc 1 221 20 discriminator 1 view .LVU164
 711 00e4 0023     		movle	r3, #0
 712 00e6 CDE7     		b	.L56
 713              	.L65:
 714              		.align	3
 715              	.L64:
 716 00e8 7B14AE47 		.word	1202590843
 717 00ec E17A843F 		.word	1065646817
 718 00f0 00000000 		.word	.LANCHOR9
 719 00f4 CDCCCCCC 		.word	-858993459
 720 00f8 00000000 		.word	.LANCHOR10
 721 00fc 00000000 		.word	0
 722 0100 0000E03F 		.word	1071644672
 723 0104 00000000 		.word	.LANCHOR11
 724 0108 00000000 		.word	.LANCHOR12
 725              		.cfi_endproc
 726              	.LFE15:
 728              		.section	.text.get_move_speed_ave,"ax",%progbits
 729              		.align	1
 730              		.global	get_move_speed_ave
 731              		.syntax unified
 732              		.thumb
 733              		.thumb_func
 734              		.fpu fpv4-sp-d16
 736              	get_move_speed_ave:
 737              	.LFB16:
 235:Src/mouse_state.c **** 
 236:Src/mouse_state.c **** //機能	: 移動平均処理後の移動速度[m/s]を取得する
 237:Src/mouse_state.c **** //引数	: なし
 238:Src/mouse_state.c **** //返り値	: 移動平均処理後の移動速度[m/s]
ARM GAS  C:\Temp\ccj03XTy.s 			page 18


 239:Src/mouse_state.c **** float get_move_speed_ave ( void )
 240:Src/mouse_state.c **** {
 738              		.loc 1 240 1 is_stmt 1 view -0
 739              		.cfi_startproc
 740              		@ args = 0, pretend = 0, frame = 0
 741              		@ frame_needed = 0, uses_anonymous_args = 0
 742              		@ link register save eliminated.
 241:Src/mouse_state.c ****     return move_speed_ave;
 743              		.loc 1 241 5 view .LVU166
 242:Src/mouse_state.c **** }
 744              		.loc 1 242 1 is_stmt 0 view .LVU167
 745 0000 014B     		ldr	r3, .L67
 746 0002 93ED000A 		vldr.32	s0, [r3]
 747 0006 7047     		bx	lr
 748              	.L68:
 749              		.align	2
 750              	.L67:
 751 0008 00000000 		.word	.LANCHOR11
 752              		.cfi_endproc
 753              	.LFE16:
 755              		.section	.text.get_move_accel_ave,"ax",%progbits
 756              		.align	1
 757              		.global	get_move_accel_ave
 758              		.syntax unified
 759              		.thumb
 760              		.thumb_func
 761              		.fpu fpv4-sp-d16
 763              	get_move_accel_ave:
 764              	.LFB17:
 243:Src/mouse_state.c **** 
 244:Src/mouse_state.c **** //機能	: 移動平均処理後の移動加速度[m/ss]を取得する
 245:Src/mouse_state.c **** //引数	: なし
 246:Src/mouse_state.c **** //返り値	: 移動平均処理後の移動速度[m/ss]
 247:Src/mouse_state.c **** float get_move_accel_ave ( void )
 248:Src/mouse_state.c **** {
 765              		.loc 1 248 1 is_stmt 1 view -0
 766              		.cfi_startproc
 767              		@ args = 0, pretend = 0, frame = 0
 768              		@ frame_needed = 0, uses_anonymous_args = 0
 769              		@ link register save eliminated.
 249:Src/mouse_state.c ****     return move_accel_ave;
 770              		.loc 1 249 5 view .LVU169
 250:Src/mouse_state.c **** }
 771              		.loc 1 250 1 is_stmt 0 view .LVU170
 772 0000 014B     		ldr	r3, .L70
 773 0002 93ED000A 		vldr.32	s0, [r3]
 774 0006 7047     		bx	lr
 775              	.L71:
 776              		.align	2
 777              	.L70:
 778 0008 00000000 		.word	.LANCHOR12
 779              		.cfi_endproc
 780              	.LFE17:
 782              		.section	.text.calc_move_length,"ax",%progbits
 783              		.align	1
 784              		.global	calc_move_length
 785              		.syntax unified
ARM GAS  C:\Temp\ccj03XTy.s 			page 19


 786              		.thumb
 787              		.thumb_func
 788              		.fpu fpv4-sp-d16
 790              	calc_move_length:
 791              	.LFB18:
 251:Src/mouse_state.c **** //機能	: マウスの移動距離[m]を計算する
 252:Src/mouse_state.c **** //引数	: なし
 253:Src/mouse_state.c **** //返り値	: なし
 254:Src/mouse_state.c **** //備考  :1msタスク
 255:Src/mouse_state.c **** void calc_move_length ( void )
 256:Src/mouse_state.c **** {
 792              		.loc 1 256 1 is_stmt 1 view -0
 793              		.cfi_startproc
 794              		@ args = 0, pretend = 0, frame = 0
 795              		@ frame_needed = 0, uses_anonymous_args = 0
 796 0000 70B5     		push	{r4, r5, r6, lr}
 797              	.LCFI10:
 798              		.cfi_def_cfa_offset 16
 799              		.cfi_offset 4, -16
 800              		.cfi_offset 5, -12
 801              		.cfi_offset 6, -8
 802              		.cfi_offset 14, -4
 257:Src/mouse_state.c ****     move_length += get_move_speed_ave() * 0.001; // [m/s] * [s]
 803              		.loc 1 257 5 view .LVU172
 804              		.loc 1 257 20 is_stmt 0 view .LVU173
 805 0002 FFF7FEFF 		bl	get_move_speed_ave
 806              	.LVL43:
 807 0006 10EE100A 		vmov	r0, s0
 808 000a FFF7FEFF 		bl	__aeabi_f2d
 809              	.LVL44:
 810              		.loc 1 257 41 view .LVU174
 811 000e 0BA3     		adr	r3, .L74+4
 812 0010 D3E90023 		ldrd	r2, [r3]
 813 0014 FFF7FEFF 		bl	__aeabi_dmul
 814              	.LVL45:
 815 0018 0446     		mov	r4, r0
 816 001a 0D46     		mov	r5, r1
 817              		.loc 1 257 17 view .LVU175
 818 001c 064E     		ldr	r6, .L74
 819 001e 3068     		ldr	r0, [r6]	@ float
 820 0020 FFF7FEFF 		bl	__aeabi_f2d
 821              	.LVL46:
 822 0024 2246     		mov	r2, r4
 823 0026 2B46     		mov	r3, r5
 824 0028 FFF7FEFF 		bl	__aeabi_dadd
 825              	.LVL47:
 826 002c FFF7FEFF 		bl	__aeabi_d2f
 827              	.LVL48:
 828 0030 3060     		str	r0, [r6]	@ float
 258:Src/mouse_state.c **** }
 829              		.loc 1 258 1 view .LVU176
 830 0032 70BD     		pop	{r4, r5, r6, pc}
 831              	.L75:
 832 0034 AFF30080 		.align	3
 833              	.L74:
 834 0038 00000000 		.word	.LANCHOR13
 835 003c FCA9F1D2 		.word	-755914244
ARM GAS  C:\Temp\ccj03XTy.s 			page 20


 836 0040 4D62503F 		.word	1062232653
 837              		.cfi_endproc
 838              	.LFE18:
 840              		.section	.text.get_move_length,"ax",%progbits
 841              		.align	1
 842              		.global	get_move_length
 843              		.syntax unified
 844              		.thumb
 845              		.thumb_func
 846              		.fpu fpv4-sp-d16
 848              	get_move_length:
 849              	.LFB19:
 259:Src/mouse_state.c **** 
 260:Src/mouse_state.c **** //機能	: マウスの移動距離[m]を取得する
 261:Src/mouse_state.c **** //引数	: なし
 262:Src/mouse_state.c **** //返り値	: なし
 263:Src/mouse_state.c **** float get_move_length ( void )
 264:Src/mouse_state.c **** {
 850              		.loc 1 264 1 is_stmt 1 view -0
 851              		.cfi_startproc
 852              		@ args = 0, pretend = 0, frame = 0
 853              		@ frame_needed = 0, uses_anonymous_args = 0
 854              		@ link register save eliminated.
 265:Src/mouse_state.c ****     return move_length;
 855              		.loc 1 265 5 view .LVU178
 266:Src/mouse_state.c **** }
 856              		.loc 1 266 1 is_stmt 0 view .LVU179
 857 0000 014B     		ldr	r3, .L77
 858 0002 93ED000A 		vldr.32	s0, [r3]
 859 0006 7047     		bx	lr
 860              	.L78:
 861              		.align	2
 862              	.L77:
 863 0008 00000000 		.word	.LANCHOR13
 864              		.cfi_endproc
 865              	.LFE19:
 867              		.section	.text.set_move_length,"ax",%progbits
 868              		.align	1
 869              		.global	set_move_length
 870              		.syntax unified
 871              		.thumb
 872              		.thumb_func
 873              		.fpu fpv4-sp-d16
 875              	set_move_length:
 876              	.LVL49:
 877              	.LFB20:
 267:Src/mouse_state.c **** 
 268:Src/mouse_state.c **** //機能	: マウスの移動距離[m]を設定する
 269:Src/mouse_state.c **** //引数	: なし
 270:Src/mouse_state.c **** //返り値	: なし
 271:Src/mouse_state.c **** void set_move_length ( float length )
 272:Src/mouse_state.c **** {
 878              		.loc 1 272 1 is_stmt 1 view -0
 879              		.cfi_startproc
 880              		@ args = 0, pretend = 0, frame = 0
 881              		@ frame_needed = 0, uses_anonymous_args = 0
 882              		@ link register save eliminated.
ARM GAS  C:\Temp\ccj03XTy.s 			page 21


 273:Src/mouse_state.c ****     move_length = length;
 883              		.loc 1 273 5 view .LVU181
 884              		.loc 1 273 17 is_stmt 0 view .LVU182
 885 0000 014B     		ldr	r3, .L80
 886 0002 83ED000A 		vstr.32	s0, [r3]
 274:Src/mouse_state.c **** }
 887              		.loc 1 274 1 view .LVU183
 888 0006 7047     		bx	lr
 889              	.L81:
 890              		.align	2
 891              	.L80:
 892 0008 00000000 		.word	.LANCHOR13
 893              		.cfi_endproc
 894              	.LFE20:
 896              		.section	.text.calc_rotation_speed,"ax",%progbits
 897              		.align	1
 898              		.global	calc_rotation_speed
 899              		.syntax unified
 900              		.thumb
 901              		.thumb_func
 902              		.fpu fpv4-sp-d16
 904              	calc_rotation_speed:
 905              	.LFB21:
 275:Src/mouse_state.c **** 
 276:Src/mouse_state.c **** //機能	: マウスの角速度[rad/s]を算出する
 277:Src/mouse_state.c **** //引数	: なし
 278:Src/mouse_state.c **** //返り値	: なし
 279:Src/mouse_state.c **** //備考 :ローパスフィルタ
 280:Src/mouse_state.c **** void calc_rotation_speed ( void )
 281:Src/mouse_state.c **** {
 906              		.loc 1 281 1 is_stmt 1 view -0
 907              		.cfi_startproc
 908              		@ args = 0, pretend = 0, frame = 0
 909              		@ frame_needed = 0, uses_anonymous_args = 0
 910 0000 70B5     		push	{r4, r5, r6, lr}
 911              	.LCFI11:
 912              		.cfi_def_cfa_offset 16
 913              		.cfi_offset 4, -16
 914              		.cfi_offset 5, -12
 915              		.cfi_offset 6, -8
 916              		.cfi_offset 14, -4
 282:Src/mouse_state.c **** 	static float post_rotation_speed;		//前回角速度
 917              		.loc 1 282 2 view .LVU185
 283:Src/mouse_state.c **** 	float tau = 1.0/(2.0*PI*cut_off_w);		//ローパスフィルタの時定数
 918              		.loc 1 283 2 view .LVU186
 919              	.LVL50:
 284:Src/mouse_state.c **** 	float den = tau + Sampling_cycle;
 920              		.loc 1 284 2 view .LVU187
 285:Src/mouse_state.c **** 
 286:Src/mouse_state.c ****     rotation_speed = (Sampling_cycle/den) * IMU_GetGyro_Z()  
 921              		.loc 1 286 5 view .LVU188
 922              		.loc 1 286 45 is_stmt 0 view .LVU189
 923 0002 FFF7FEFF 		bl	IMU_GetGyro_Z
 924              	.LVL51:
 925 0006 10EE100A 		vmov	r0, s0
 926 000a FFF7FEFF 		bl	__aeabi_f2d
 927              	.LVL52:
ARM GAS  C:\Temp\ccj03XTy.s 			page 22


 928              		.loc 1 286 43 view .LVU190
 929 000e 13A3     		adr	r3, .L84+12
 930 0010 D3E90023 		ldrd	r2, [r3]
 931 0014 FFF7FEFF 		bl	__aeabi_dmul
 932              	.LVL53:
 933 0018 0446     		mov	r4, r0
 934 001a 0D46     		mov	r5, r1
 287:Src/mouse_state.c **** 						 + (tau / den) * post_rotation_speed;
 935              		.loc 1 287 22 view .LVU191
 936 001c 0C4E     		ldr	r6, .L84
 937 001e 96ED007A 		vldr.32	s14, [r6]
 938 0022 DFED0C7A 		vldr.32	s15, .L84+4
 939 0026 67EE277A 		vmul.f32	s15, s14, s15
 940 002a 17EE900A 		vmov	r0, s15
 941 002e FFF7FEFF 		bl	__aeabi_f2d
 942              	.LVL54:
 943 0032 0246     		mov	r2, r0
 944 0034 0B46     		mov	r3, r1
 945              		.loc 1 287 8 view .LVU192
 946 0036 2046     		mov	r0, r4
 947 0038 2946     		mov	r1, r5
 948 003a FFF7FEFF 		bl	__aeabi_dadd
 949              	.LVL55:
 950 003e FFF7FEFF 		bl	__aeabi_d2f
 951              	.LVL56:
 286:Src/mouse_state.c **** 						 + (tau / den) * post_rotation_speed;
 952              		.loc 1 286 20 view .LVU193
 953 0042 054B     		ldr	r3, .L84+8
 954 0044 1860     		str	r0, [r3]	@ float
 288:Src/mouse_state.c **** 
 289:Src/mouse_state.c **** 	post_rotation_speed = rotation_speed; //前回値更新
 955              		.loc 1 289 2 is_stmt 1 view .LVU194
 956              		.loc 1 289 22 is_stmt 0 view .LVU195
 957 0046 3060     		str	r0, [r6]	@ float
 290:Src/mouse_state.c **** }
 958              		.loc 1 290 1 view .LVU196
 959 0048 70BD     		pop	{r4, r5, r6, pc}
 960              	.L85:
 961 004a 00BFAFF3 		.align	3
 961      0080
 962              	.L84:
 963 0050 00000000 		.word	.LANCHOR14
 964 0054 A7BB913E 		.word	1049738151
 965 0058 00000000 		.word	.LANCHOR15
 966 005c 51FF2F9A 		.word	-1708130479
 967 0060 45E4E63F 		.word	1072096325
 968              		.cfi_endproc
 969              	.LFE21:
 971              		.section	.text.get_rotation_speed,"ax",%progbits
 972              		.align	1
 973              		.global	get_rotation_speed
 974              		.syntax unified
 975              		.thumb
 976              		.thumb_func
 977              		.fpu fpv4-sp-d16
 979              	get_rotation_speed:
 980              	.LFB22:
ARM GAS  C:\Temp\ccj03XTy.s 			page 23


 291:Src/mouse_state.c **** 
 292:Src/mouse_state.c **** //機能	: マウスの角速度を取得する
 293:Src/mouse_state.c **** //引数	: なし
 294:Src/mouse_state.c **** //返り値	: マウスの角速度[rad/s]
 295:Src/mouse_state.c **** float get_rotation_speed ( void )
 296:Src/mouse_state.c **** {
 981              		.loc 1 296 1 is_stmt 1 view -0
 982              		.cfi_startproc
 983              		@ args = 0, pretend = 0, frame = 0
 984              		@ frame_needed = 0, uses_anonymous_args = 0
 985              		@ link register save eliminated.
 297:Src/mouse_state.c ****     return rotation_speed;
 986              		.loc 1 297 5 view .LVU198
 298:Src/mouse_state.c **** }
 987              		.loc 1 298 1 is_stmt 0 view .LVU199
 988 0000 014B     		ldr	r3, .L87
 989 0002 93ED000A 		vldr.32	s0, [r3]
 990 0006 7047     		bx	lr
 991              	.L88:
 992              		.align	2
 993              	.L87:
 994 0008 00000000 		.word	.LANCHOR15
 995              		.cfi_endproc
 996              	.LFE22:
 998              		.section	.text.calc_rotation_angle,"ax",%progbits
 999              		.align	1
 1000              		.global	calc_rotation_angle
 1001              		.syntax unified
 1002              		.thumb
 1003              		.thumb_func
 1004              		.fpu fpv4-sp-d16
 1006              	calc_rotation_angle:
 1007              	.LFB23:
 299:Src/mouse_state.c **** 
 300:Src/mouse_state.c **** //機能	: マウスの角度[rad/s]を算出する
 301:Src/mouse_state.c **** //引数	: なし
 302:Src/mouse_state.c **** //返り値	: なし
 303:Src/mouse_state.c **** //備考 :1msタスク
 304:Src/mouse_state.c **** void calc_rotation_angle ( void )
 305:Src/mouse_state.c **** {
 1008              		.loc 1 305 1 is_stmt 1 view -0
 1009              		.cfi_startproc
 1010              		@ args = 0, pretend = 0, frame = 0
 1011              		@ frame_needed = 0, uses_anonymous_args = 0
 1012 0000 70B5     		push	{r4, r5, r6, lr}
 1013              	.LCFI12:
 1014              		.cfi_def_cfa_offset 16
 1015              		.cfi_offset 4, -16
 1016              		.cfi_offset 5, -12
 1017              		.cfi_offset 6, -8
 1018              		.cfi_offset 14, -4
 306:Src/mouse_state.c ****     rotation_angle += rotation_speed * 0.001; // [rad/s] * [s]
 1019              		.loc 1 306 5 view .LVU201
 1020              		.loc 1 306 38 is_stmt 0 view .LVU202
 1021 0002 0D4B     		ldr	r3, .L91+8
 1022 0004 1868     		ldr	r0, [r3]	@ float
 1023 0006 FFF7FEFF 		bl	__aeabi_f2d
ARM GAS  C:\Temp\ccj03XTy.s 			page 24


 1024              	.LVL57:
 1025 000a 09A3     		adr	r3, .L91
 1026 000c D3E90023 		ldrd	r2, [r3]
 1027 0010 FFF7FEFF 		bl	__aeabi_dmul
 1028              	.LVL58:
 1029 0014 0446     		mov	r4, r0
 1030 0016 0D46     		mov	r5, r1
 1031              		.loc 1 306 20 view .LVU203
 1032 0018 084E     		ldr	r6, .L91+12
 1033 001a 3068     		ldr	r0, [r6]	@ float
 1034 001c FFF7FEFF 		bl	__aeabi_f2d
 1035              	.LVL59:
 1036 0020 2246     		mov	r2, r4
 1037 0022 2B46     		mov	r3, r5
 1038 0024 FFF7FEFF 		bl	__aeabi_dadd
 1039              	.LVL60:
 1040 0028 FFF7FEFF 		bl	__aeabi_d2f
 1041              	.LVL61:
 1042 002c 3060     		str	r0, [r6]	@ float
 307:Src/mouse_state.c **** }
 1043              		.loc 1 307 1 view .LVU204
 1044 002e 70BD     		pop	{r4, r5, r6, pc}
 1045              	.L92:
 1046              		.align	3
 1047              	.L91:
 1048 0030 FCA9F1D2 		.word	-755914244
 1049 0034 4D62503F 		.word	1062232653
 1050 0038 00000000 		.word	.LANCHOR15
 1051 003c 00000000 		.word	.LANCHOR16
 1052              		.cfi_endproc
 1053              	.LFE23:
 1055              		.section	.text.mouse_state_1ms,"ax",%progbits
 1056              		.align	1
 1057              		.global	mouse_state_1ms
 1058              		.syntax unified
 1059              		.thumb
 1060              		.thumb_func
 1061              		.fpu fpv4-sp-d16
 1063              	mouse_state_1ms:
 1064              	.LFB3:
  31:Src/mouse_state.c **** //	calc_move_speed();		//速度計算
 1065              		.loc 1 31 1 is_stmt 1 view -0
 1066              		.cfi_startproc
 1067              		@ args = 0, pretend = 0, frame = 0
 1068              		@ frame_needed = 0, uses_anonymous_args = 0
 1069 0000 08B5     		push	{r3, lr}
 1070              	.LCFI13:
 1071              		.cfi_def_cfa_offset 8
 1072              		.cfi_offset 3, -8
 1073              		.cfi_offset 14, -4
  33:Src/mouse_state.c **** //	filter_move_speed();	//速度をフィルタ処理
 1074              		.loc 1 33 2 view .LVU206
 1075 0002 FFF7FEFF 		bl	calc_rotation_speed
 1076              	.LVL62:
  35:Src/mouse_state.c **** 	calc_rotation_angle();	//回転角度を計算
 1077              		.loc 1 35 2 view .LVU207
 1078 0006 FFF7FEFF 		bl	calc_move_length
ARM GAS  C:\Temp\ccj03XTy.s 			page 25


 1079              	.LVL63:
  36:Src/mouse_state.c **** }
 1080              		.loc 1 36 2 view .LVU208
 1081 000a FFF7FEFF 		bl	calc_rotation_angle
 1082              	.LVL64:
  37:Src/mouse_state.c **** 
 1083              		.loc 1 37 1 is_stmt 0 view .LVU209
 1084 000e 08BD     		pop	{r3, pc}
 1085              		.cfi_endproc
 1086              	.LFE3:
 1088              		.section	.text.get_rotation_angle,"ax",%progbits
 1089              		.align	1
 1090              		.global	get_rotation_angle
 1091              		.syntax unified
 1092              		.thumb
 1093              		.thumb_func
 1094              		.fpu fpv4-sp-d16
 1096              	get_rotation_angle:
 1097              	.LFB24:
 308:Src/mouse_state.c **** 
 309:Src/mouse_state.c **** //機能	: マウスの角度を取得する
 310:Src/mouse_state.c **** //引数	: なし
 311:Src/mouse_state.c **** //返り値	: マウスの角度[rad]
 312:Src/mouse_state.c **** float get_rotation_angle ( void )
 313:Src/mouse_state.c **** {
 1098              		.loc 1 313 1 is_stmt 1 view -0
 1099              		.cfi_startproc
 1100              		@ args = 0, pretend = 0, frame = 0
 1101              		@ frame_needed = 0, uses_anonymous_args = 0
 1102              		@ link register save eliminated.
 314:Src/mouse_state.c ****     return rotation_angle;
 1103              		.loc 1 314 5 view .LVU211
 315:Src/mouse_state.c **** }
 1104              		.loc 1 315 1 is_stmt 0 view .LVU212
 1105 0000 014B     		ldr	r3, .L96
 1106 0002 93ED000A 		vldr.32	s0, [r3]
 1107 0006 7047     		bx	lr
 1108              	.L97:
 1109              		.align	2
 1110              	.L96:
 1111 0008 00000000 		.word	.LANCHOR16
 1112              		.cfi_endproc
 1113              	.LFE24:
 1115              		.section	.text.set_rotation_angle,"ax",%progbits
 1116              		.align	1
 1117              		.global	set_rotation_angle
 1118              		.syntax unified
 1119              		.thumb
 1120              		.thumb_func
 1121              		.fpu fpv4-sp-d16
 1123              	set_rotation_angle:
 1124              	.LVL65:
 1125              	.LFB25:
 316:Src/mouse_state.c **** 
 317:Src/mouse_state.c **** //機能	: マウスの角度を取得する
 318:Src/mouse_state.c **** //引数	: なし
 319:Src/mouse_state.c **** //返り値	: なし
ARM GAS  C:\Temp\ccj03XTy.s 			page 26


 320:Src/mouse_state.c **** void set_rotation_angle ( float angle )
 321:Src/mouse_state.c **** {
 1126              		.loc 1 321 1 is_stmt 1 view -0
 1127              		.cfi_startproc
 1128              		@ args = 0, pretend = 0, frame = 0
 1129              		@ frame_needed = 0, uses_anonymous_args = 0
 1130              		@ link register save eliminated.
 322:Src/mouse_state.c ****     rotation_angle = angle;
 1131              		.loc 1 322 5 view .LVU214
 1132              		.loc 1 322 20 is_stmt 0 view .LVU215
 1133 0000 014B     		ldr	r3, .L99
 1134 0002 83ED000A 		vstr.32	s0, [r3]
 323:Src/mouse_state.c **** }
 1135              		.loc 1 323 1 view .LVU216
 1136 0006 7047     		bx	lr
 1137              	.L100:
 1138              		.align	2
 1139              	.L99:
 1140 0008 00000000 		.word	.LANCHOR16
 1141              		.cfi_endproc
 1142              	.LFE25:
 1144              		.section	.text.speed_estimate_kalman,"ax",%progbits
 1145              		.align	1
 1146              		.global	speed_estimate_kalman
 1147              		.syntax unified
 1148              		.thumb
 1149              		.thumb_func
 1150              		.fpu fpv4-sp-d16
 1152              	speed_estimate_kalman:
 1153              	.LFB26:
 324:Src/mouse_state.c **** 
 325:Src/mouse_state.c **** 
 326:Src/mouse_state.c **** //機能	: カルマンフィルタによる速度推定
 327:Src/mouse_state.c **** //引数	: なし
 328:Src/mouse_state.c **** //返り値	: なし
 329:Src/mouse_state.c **** //備考	:1msタスク
 330:Src/mouse_state.c **** void speed_estimate_kalman ( void )
 331:Src/mouse_state.c **** {
 1154              		.loc 1 331 1 is_stmt 1 view -0
 1155              		.cfi_startproc
 1156              		@ args = 0, pretend = 0, frame = 24
 1157              		@ frame_needed = 0, uses_anonymous_args = 0
 1158 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1159              	.LCFI14:
 1160              		.cfi_def_cfa_offset 36
 1161              		.cfi_offset 4, -36
 1162              		.cfi_offset 5, -32
 1163              		.cfi_offset 6, -28
 1164              		.cfi_offset 7, -24
 1165              		.cfi_offset 8, -20
 1166              		.cfi_offset 9, -16
 1167              		.cfi_offset 10, -12
 1168              		.cfi_offset 11, -8
 1169              		.cfi_offset 14, -4
 1170 0004 2DED068B 		vpush.64	{d8, d9, d10}
 1171              	.LCFI15:
 1172              		.cfi_def_cfa_offset 60
ARM GAS  C:\Temp\ccj03XTy.s 			page 27


 1173              		.cfi_offset 80, -60
 1174              		.cfi_offset 81, -56
 1175              		.cfi_offset 82, -52
 1176              		.cfi_offset 83, -48
 1177              		.cfi_offset 84, -44
 1178              		.cfi_offset 85, -40
 1179 0008 87B0     		sub	sp, sp, #28
 1180              	.LCFI16:
 1181              		.cfi_def_cfa_offset 88
 332:Src/mouse_state.c **** 
 333:Src/mouse_state.c **** 	float odo_x = 0;
 1182              		.loc 1 333 2 view .LVU218
 1183              	.LVL66:
 334:Src/mouse_state.c **** 	float odo_v = 0;
 1184              		.loc 1 334 2 view .LVU219
 335:Src/mouse_state.c **** 	static float est_x = 0;
 1185              		.loc 1 335 2 view .LVU220
 336:Src/mouse_state.c **** 	static float est_v = 0;
 1186              		.loc 1 336 2 view .LVU221
 337:Src/mouse_state.c **** 
 338:Src/mouse_state.c **** 	float P11_before = 0;
 1187              		.loc 1 338 2 view .LVU222
 339:Src/mouse_state.c **** 	float P12_before = 0;
 1188              		.loc 1 339 2 view .LVU223
 340:Src/mouse_state.c **** 	float P21_before = 0;
 1189              		.loc 1 340 2 view .LVU224
 341:Src/mouse_state.c **** 	float P22_before = 0;
 1190              		.loc 1 341 2 view .LVU225
 342:Src/mouse_state.c **** 
 343:Src/mouse_state.c **** 	static float P11_after = 0;
 1191              		.loc 1 343 2 view .LVU226
 344:Src/mouse_state.c **** 	static float P12_after = 0;
 1192              		.loc 1 344 2 view .LVU227
 345:Src/mouse_state.c **** 	static float P21_after = 0;
 1193              		.loc 1 345 2 view .LVU228
 346:Src/mouse_state.c **** 	static float P22_after = 0;
 1194              		.loc 1 346 2 view .LVU229
 347:Src/mouse_state.c **** 
 348:Src/mouse_state.c **** 	float inv_vec = 0;
 1195              		.loc 1 348 2 view .LVU230
 349:Src/mouse_state.c **** 	float kalman_gain_den = 0;
 1196              		.loc 1 349 2 view .LVU231
 350:Src/mouse_state.c **** 	float kalman_gain_x = 0;
 1197              		.loc 1 350 2 view .LVU232
 351:Src/mouse_state.c **** 	float kalman_gain_v = 0;
 1198              		.loc 1 351 2 view .LVU233
 352:Src/mouse_state.c **** 
 353:Src/mouse_state.c **** 	  ////////////////////
 354:Src/mouse_state.c **** 	 //	 予測ステップ	//
 355:Src/mouse_state.c **** 	////////////////////
 356:Src/mouse_state.c **** 
 357:Src/mouse_state.c **** 	//オドメトリによる事前推定値
 358:Src/mouse_state.c **** 	odo_x = est_x + dt * est_v + 0.5 * dt2 * IMU_GetAccel_X();
 1199              		.loc 1 358 2 view .LVU234
 1200              		.loc 1 358 21 is_stmt 0 view .LVU235
 1201 000a 8D4C     		ldr	r4, .L103+40
 1202 000c 2068     		ldr	r0, [r4]	@ float
ARM GAS  C:\Temp\ccj03XTy.s 			page 28


 1203 000e FFF7FEFF 		bl	__aeabi_f2d
 1204              	.LVL67:
 1205 0012 81A3     		adr	r3, .L103
 1206 0014 D3E90023 		ldrd	r2, [r3]
 1207 0018 FFF7FEFF 		bl	__aeabi_dmul
 1208              	.LVL68:
 1209 001c 0646     		mov	r6, r0
 1210 001e 0F46     		mov	r7, r1
 1211              		.loc 1 358 16 view .LVU236
 1212 0020 DFF82492 		ldr	r9, .L103+48
 1213 0024 D9F80000 		ldr	r0, [r9]	@ float
 1214 0028 FFF7FEFF 		bl	__aeabi_f2d
 1215              	.LVL69:
 1216 002c 3246     		mov	r2, r6
 1217 002e 3B46     		mov	r3, r7
 1218 0030 FFF7FEFF 		bl	__aeabi_dadd
 1219              	.LVL70:
 1220 0034 0646     		mov	r6, r0
 1221 0036 0F46     		mov	r7, r1
 1222              		.loc 1 358 43 view .LVU237
 1223 0038 FFF7FEFF 		bl	IMU_GetAccel_X
 1224              	.LVL71:
 1225 003c 10EE100A 		vmov	r0, s0
 1226 0040 FFF7FEFF 		bl	__aeabi_f2d
 1227              	.LVL72:
 1228              		.loc 1 358 41 view .LVU238
 1229 0044 76A3     		adr	r3, .L103+8
 1230 0046 D3E90023 		ldrd	r2, [r3]
 1231 004a FFF7FEFF 		bl	__aeabi_dmul
 1232              	.LVL73:
 1233 004e 0246     		mov	r2, r0
 1234 0050 0B46     		mov	r3, r1
 1235              		.loc 1 358 29 view .LVU239
 1236 0052 3046     		mov	r0, r6
 1237 0054 3946     		mov	r1, r7
 1238 0056 FFF7FEFF 		bl	__aeabi_dadd
 1239              	.LVL74:
 1240              		.loc 1 358 8 view .LVU240
 1241 005a FFF7FEFF 		bl	__aeabi_d2f
 1242              	.LVL75:
 1243 005e 0AEE900A 		vmov	s21, r0
 1244              	.LVL76:
 359:Src/mouse_state.c **** 	odo_v = est_v + dt * IMU_GetAccel_X();
 1245              		.loc 1 359 2 is_stmt 1 view .LVU241
 1246              		.loc 1 359 16 is_stmt 0 view .LVU242
 1247 0062 2068     		ldr	r0, [r4]	@ float
 1248              	.LVL77:
 1249              		.loc 1 359 16 view .LVU243
 1250 0064 FFF7FEFF 		bl	__aeabi_f2d
 1251              	.LVL78:
 1252 0068 0646     		mov	r6, r0
 1253 006a 0F46     		mov	r7, r1
 1254              		.loc 1 359 23 view .LVU244
 1255 006c FFF7FEFF 		bl	IMU_GetAccel_X
 1256              	.LVL79:
 1257 0070 10EE100A 		vmov	r0, s0
 1258 0074 FFF7FEFF 		bl	__aeabi_f2d
ARM GAS  C:\Temp\ccj03XTy.s 			page 29


 1259              	.LVL80:
 1260              		.loc 1 359 21 view .LVU245
 1261 0078 67A3     		adr	r3, .L103
 1262 007a D3E90023 		ldrd	r2, [r3]
 1263 007e FFF7FEFF 		bl	__aeabi_dmul
 1264              	.LVL81:
 1265 0082 0246     		mov	r2, r0
 1266 0084 0B46     		mov	r3, r1
 1267              		.loc 1 359 16 view .LVU246
 1268 0086 3046     		mov	r0, r6
 1269 0088 3946     		mov	r1, r7
 1270 008a FFF7FEFF 		bl	__aeabi_dadd
 1271              	.LVL82:
 1272              		.loc 1 359 8 view .LVU247
 1273 008e FFF7FEFF 		bl	__aeabi_d2f
 1274              	.LVL83:
 1275 0092 0AEE100A 		vmov	s20, r0
 1276              	.LVL84:
 360:Src/mouse_state.c **** 	
 361:Src/mouse_state.c **** 	//事前推定値の誤差分散計算
 362:Src/mouse_state.c **** 	P11_before = P11_after + dt*P21_after + dt*P12_after + dt2*P22_after + 0.25*dt4*IMU_X_dispersion2;
 1277              		.loc 1 362 2 is_stmt 1 view .LVU248
 1278              		.loc 1 362 29 is_stmt 0 view .LVU249
 1279 0096 6B4D     		ldr	r5, .L103+44
 1280 0098 2868     		ldr	r0, [r5]	@ float
 1281              	.LVL85:
 1282              		.loc 1 362 29 view .LVU250
 1283 009a FFF7FEFF 		bl	__aeabi_f2d
 1284              	.LVL86:
 1285 009e 0246     		mov	r2, r0
 1286 00a0 0B46     		mov	r3, r1
 1287 00a2 CDE90223 		strd	r2, [sp, #8]
 1288 00a6 5CA3     		adr	r3, .L103
 1289 00a8 D3E90023 		ldrd	r2, [r3]
 1290 00ac FFF7FEFF 		bl	__aeabi_dmul
 1291              	.LVL87:
 1292 00b0 0646     		mov	r6, r0
 1293 00b2 0F46     		mov	r7, r1
 1294              		.loc 1 362 25 view .LVU251
 1295 00b4 DFF89481 		ldr	r8, .L103+52
 1296 00b8 D8F80000 		ldr	r0, [r8]	@ float
 1297 00bc FFF7FEFF 		bl	__aeabi_f2d
 1298              	.LVL88:
 1299 00c0 3246     		mov	r2, r6
 1300 00c2 3B46     		mov	r3, r7
 1301 00c4 FFF7FEFF 		bl	__aeabi_dadd
 1302              	.LVL89:
 1303 00c8 0646     		mov	r6, r0
 1304 00ca 0F46     		mov	r7, r1
 1305              		.loc 1 362 44 view .LVU252
 1306 00cc DFF880A1 		ldr	r10, .L103+56
 1307 00d0 DAF80000 		ldr	r0, [r10]	@ float
 1308 00d4 FFF7FEFF 		bl	__aeabi_f2d
 1309              	.LVL90:
 1310 00d8 0246     		mov	r2, r0
 1311 00da 0B46     		mov	r3, r1
 1312 00dc CDE90423 		strd	r2, [sp, #16]
ARM GAS  C:\Temp\ccj03XTy.s 			page 30


 1313 00e0 4DA3     		adr	r3, .L103
 1314 00e2 D3E90023 		ldrd	r2, [r3]
 1315 00e6 FFF7FEFF 		bl	__aeabi_dmul
 1316              	.LVL91:
 1317 00ea 0246     		mov	r2, r0
 1318 00ec 0B46     		mov	r3, r1
 1319              		.loc 1 362 40 view .LVU253
 1320 00ee 3046     		mov	r0, r6
 1321 00f0 3946     		mov	r1, r7
 1322 00f2 FFF7FEFF 		bl	__aeabi_dadd
 1323              	.LVL92:
 1324 00f6 0646     		mov	r6, r0
 1325 00f8 0F46     		mov	r7, r1
 1326              		.loc 1 362 60 view .LVU254
 1327 00fa DFF858B1 		ldr	fp, .L103+60
 1328 00fe DBF80000 		ldr	r0, [fp]	@ float
 1329 0102 FFF7FEFF 		bl	__aeabi_f2d
 1330              	.LVL93:
 1331 0106 0246     		mov	r2, r0
 1332 0108 0B46     		mov	r3, r1
 1333 010a CDE90023 		strd	r2, [sp]
 1334 010e 46A3     		adr	r3, .L103+16
 1335 0110 D3E90023 		ldrd	r2, [r3]
 1336 0114 FFF7FEFF 		bl	__aeabi_dmul
 1337              	.LVL94:
 1338 0118 0246     		mov	r2, r0
 1339 011a 0B46     		mov	r3, r1
 1340              		.loc 1 362 55 view .LVU255
 1341 011c 3046     		mov	r0, r6
 1342 011e 3946     		mov	r1, r7
 1343 0120 FFF7FEFF 		bl	__aeabi_dadd
 1344              	.LVL95:
 1345              		.loc 1 362 71 view .LVU256
 1346 0124 42A3     		adr	r3, .L103+24
 1347 0126 D3E90023 		ldrd	r2, [r3]
 1348 012a FFF7FEFF 		bl	__aeabi_dadd
 1349              	.LVL96:
 1350              		.loc 1 362 13 view .LVU257
 1351 012e FFF7FEFF 		bl	__aeabi_d2f
 1352              	.LVL97:
 1353 0132 09EE900A 		vmov	s19, r0
 1354              	.LVL98:
 363:Src/mouse_state.c **** 	P12_before = P12_after + dt*P22_after + 0.5*dt3*IMU_X_dispersion2;
 1355              		.loc 1 363 2 is_stmt 1 view .LVU258
 1356              		.loc 1 363 29 is_stmt 0 view .LVU259
 1357 0136 38A3     		adr	r3, .L103
 1358 0138 D3E90023 		ldrd	r2, [r3]
 1359 013c DDE90001 		ldrd	r0, [sp]
 1360              	.LVL99:
 1361              		.loc 1 363 29 view .LVU260
 1362 0140 FFF7FEFF 		bl	__aeabi_dmul
 1363              	.LVL100:
 1364 0144 0646     		mov	r6, r0
 1365 0146 0F46     		mov	r7, r1
 1366              		.loc 1 363 25 view .LVU261
 1367 0148 0246     		mov	r2, r0
 1368 014a 0B46     		mov	r3, r1
ARM GAS  C:\Temp\ccj03XTy.s 			page 31


 1369 014c DDE90401 		ldrd	r0, [sp, #16]
 1370 0150 FFF7FEFF 		bl	__aeabi_dadd
 1371              	.LVL101:
 1372              		.loc 1 363 40 view .LVU262
 1373 0154 38A3     		adr	r3, .L103+32
 1374 0156 D3E90023 		ldrd	r2, [r3]
 1375 015a FFF7FEFF 		bl	__aeabi_dadd
 1376              	.LVL102:
 1377              		.loc 1 363 13 view .LVU263
 1378 015e FFF7FEFF 		bl	__aeabi_d2f
 1379              	.LVL103:
 1380 0162 08EE900A 		vmov	s17, r0
 1381              	.LVL104:
 364:Src/mouse_state.c **** 	P21_before = P21_after + dt*P22_after + 0.5*dt3*IMU_X_dispersion2;
 1382              		.loc 1 364 2 is_stmt 1 view .LVU264
 1383              		.loc 1 364 25 is_stmt 0 view .LVU265
 1384 0166 3246     		mov	r2, r6
 1385 0168 3B46     		mov	r3, r7
 1386 016a DDE90201 		ldrd	r0, [sp, #8]
 1387              	.LVL105:
 1388              		.loc 1 364 25 view .LVU266
 1389 016e FFF7FEFF 		bl	__aeabi_dadd
 1390              	.LVL106:
 1391              		.loc 1 364 40 view .LVU267
 1392 0172 31A3     		adr	r3, .L103+32
 1393 0174 D3E90023 		ldrd	r2, [r3]
 1394 0178 FFF7FEFF 		bl	__aeabi_dadd
 1395              	.LVL107:
 1396              		.loc 1 364 13 view .LVU268
 1397 017c FFF7FEFF 		bl	__aeabi_d2f
 1398              	.LVL108:
 1399 0180 09EE100A 		vmov	s18, r0
 1400              	.LVL109:
 365:Src/mouse_state.c **** 	P22_before = P22_after + dt2*IMU_X_dispersion2;
 1401              		.loc 1 365 2 is_stmt 1 view .LVU269
 1402              		.loc 1 365 25 is_stmt 0 view .LVU270
 1403 0184 28A3     		adr	r3, .L103+16
 1404 0186 D3E90023 		ldrd	r2, [r3]
 1405 018a DDE90001 		ldrd	r0, [sp]
 1406              	.LVL110:
 1407              		.loc 1 365 25 view .LVU271
 1408 018e FFF7FEFF 		bl	__aeabi_dadd
 1409              	.LVL111:
 1410              		.loc 1 365 13 view .LVU272
 1411 0192 FFF7FEFF 		bl	__aeabi_d2f
 1412              	.LVL112:
 1413 0196 08EE100A 		vmov	s16, r0
 1414              	.LVL113:
 366:Src/mouse_state.c **** 
 367:Src/mouse_state.c **** 	  ///////////////////////////
 368:Src/mouse_state.c **** 	 //	 フィルタリングステップ	//
 369:Src/mouse_state.c **** 	///////////////////////////
 370:Src/mouse_state.c **** 
 371:Src/mouse_state.c **** 	//イノベーションベクトルの算出
 372:Src/mouse_state.c **** 	inv_vec = get_move_speed() - odo_v;
 1415              		.loc 1 372 2 is_stmt 1 view .LVU273
 1416              		.loc 1 372 12 is_stmt 0 view .LVU274
ARM GAS  C:\Temp\ccj03XTy.s 			page 32


 1417 019a FFF7FEFF 		bl	get_move_speed
 1418              	.LVL114:
 1419              		.loc 1 372 10 view .LVU275
 1420 019e 30EE4A0A 		vsub.f32	s0, s0, s20
 1421              	.LVL115:
 373:Src/mouse_state.c **** 
 374:Src/mouse_state.c **** 	//kalman filterのgain算出
 375:Src/mouse_state.c **** 	kalman_gain_den = P22_before + encorder_dispersion2;
 1422              		.loc 1 375 2 is_stmt 1 view .LVU276
 1423              		.loc 1 375 18 is_stmt 0 view .LVU277
 1424 01a2 F7EE007A 		vmov.f32	s15, #1.0e+0
 1425 01a6 78EE277A 		vadd.f32	s15, s16, s15
 1426              	.LVL116:
 376:Src/mouse_state.c **** 	kalman_gain_x = P12_before / kalman_gain_den;
 1427              		.loc 1 376 2 is_stmt 1 view .LVU278
 1428              		.loc 1 376 16 is_stmt 0 view .LVU279
 1429 01aa 88EEA77A 		vdiv.f32	s14, s17, s15
 1430              	.LVL117:
 377:Src/mouse_state.c **** 	kalman_gain_v = P22_before / kalman_gain_den;
 1431              		.loc 1 377 2 is_stmt 1 view .LVU280
 1432              		.loc 1 377 16 is_stmt 0 view .LVU281
 1433 01ae C8EE276A 		vdiv.f32	s13, s16, s15
 1434              	.LVL118:
 378:Src/mouse_state.c **** 
 379:Src/mouse_state.c **** 	//状態推定値更新
 380:Src/mouse_state.c **** 	est_x = odo_x + inv_vec * kalman_gain_x;
 1435              		.loc 1 380 2 is_stmt 1 view .LVU282
 1436              		.loc 1 380 26 is_stmt 0 view .LVU283
 1437 01b2 20EE077A 		vmul.f32	s14, s0, s14
 1438              	.LVL119:
 1439              		.loc 1 380 16 view .LVU284
 1440 01b6 37EE2A7A 		vadd.f32	s14, s14, s21
 1441              		.loc 1 380 8 view .LVU285
 1442 01ba 89ED007A 		vstr.32	s14, [r9]
 381:Src/mouse_state.c **** 	est_v = odo_v + inv_vec * kalman_gain_v;
 1443              		.loc 1 381 2 is_stmt 1 view .LVU286
 1444              		.loc 1 381 26 is_stmt 0 view .LVU287
 1445 01be 20EE260A 		vmul.f32	s0, s0, s13
 1446              	.LVL120:
 1447              		.loc 1 381 16 view .LVU288
 1448 01c2 30EE0A0A 		vadd.f32	s0, s0, s20
 1449              		.loc 1 381 8 view .LVU289
 1450 01c6 84ED000A 		vstr.32	s0, [r4]
 382:Src/mouse_state.c **** 	
 383:Src/mouse_state.c **** 	//推定誤差分散更新
 384:Src/mouse_state.c **** 	P11_after = P11_before - P12_before * P21_before / kalman_gain_den;
 1451              		.loc 1 384 2 is_stmt 1 view .LVU290
 1452              		.loc 1 384 38 is_stmt 0 view .LVU291
 1453 01ca 68EE896A 		vmul.f32	s13, s17, s18
 1454              	.LVL121:
 1455              		.loc 1 384 51 view .LVU292
 1456 01ce 86EEA77A 		vdiv.f32	s14, s13, s15
 1457              		.loc 1 384 25 view .LVU293
 1458 01d2 79EEC79A 		vsub.f32	s19, s19, s14
 1459              	.LVL122:
 1460              		.loc 1 384 12 view .LVU294
 1461 01d6 C8ED009A 		vstr.32	s19, [r8]
ARM GAS  C:\Temp\ccj03XTy.s 			page 33


 385:Src/mouse_state.c **** 	P12_after = P12_before - P12_before * P22_before / kalman_gain_den;
 1462              		.loc 1 385 2 is_stmt 1 view .LVU295
 1463              		.loc 1 385 38 is_stmt 0 view .LVU296
 1464 01da 68EE886A 		vmul.f32	s13, s17, s16
 1465              		.loc 1 385 51 view .LVU297
 1466 01de 86EEA77A 		vdiv.f32	s14, s13, s15
 1467              		.loc 1 385 25 view .LVU298
 1468 01e2 78EEC78A 		vsub.f32	s17, s17, s14
 1469              	.LVL123:
 1470              		.loc 1 385 12 view .LVU299
 1471 01e6 CAED008A 		vstr.32	s17, [r10]
 386:Src/mouse_state.c **** 	P21_after = P21_before - P21_before * P22_before / kalman_gain_den;
 1472              		.loc 1 386 2 is_stmt 1 view .LVU300
 1473              		.loc 1 386 38 is_stmt 0 view .LVU301
 1474 01ea 69EE086A 		vmul.f32	s13, s18, s16
 1475              		.loc 1 386 51 view .LVU302
 1476 01ee 86EEA77A 		vdiv.f32	s14, s13, s15
 1477              		.loc 1 386 25 view .LVU303
 1478 01f2 39EE479A 		vsub.f32	s18, s18, s14
 1479              	.LVL124:
 1480              		.loc 1 386 12 view .LVU304
 1481 01f6 85ED009A 		vstr.32	s18, [r5]
 387:Src/mouse_state.c **** 	P22_after = P22_before - P22_before * P22_before / kalman_gain_den;
 1482              		.loc 1 387 2 is_stmt 1 view .LVU305
 1483              		.loc 1 387 38 is_stmt 0 view .LVU306
 1484 01fa 68EE086A 		vmul.f32	s13, s16, s16
 1485              		.loc 1 387 51 view .LVU307
 1486 01fe 86EEA77A 		vdiv.f32	s14, s13, s15
 1487              		.loc 1 387 25 view .LVU308
 1488 0202 38EE478A 		vsub.f32	s16, s16, s14
 1489              	.LVL125:
 1490              		.loc 1 387 12 view .LVU309
 1491 0206 8BED008A 		vstr.32	s16, [fp]
 388:Src/mouse_state.c **** 
 389:Src/mouse_state.c **** }...
 1492              		.loc 1 389 1 view .LVU310
 1493 020a 07B0     		add	sp, sp, #28
 1494              	.LCFI17:
 1495              		.cfi_def_cfa_offset 60
 1496              		@ sp needed
 1497 020c BDEC068B 		vldm	sp!, {d8-d10}
 1498              	.LCFI18:
 1499              		.cfi_restore 84
 1500              		.cfi_restore 85
 1501              		.cfi_restore 82
 1502              		.cfi_restore 83
 1503              		.cfi_restore 80
 1504              		.cfi_restore 81
 1505              		.cfi_def_cfa_offset 36
 1506              	.LVL126:
 1507              		.loc 1 389 1 view .LVU311
 1508 0210 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1509              	.L104:
 1510 0214 AFF30080 		.align	3
 1511              	.L103:
 1512 0218 FCA9F1D2 		.word	-755914244
 1513 021c 4D62503F 		.word	1062232653
ARM GAS  C:\Temp\ccj03XTy.s 			page 34


 1514 0220 8DEDB5A0 		.word	-1598689907
 1515 0224 F7C6A03E 		.word	1050724087
 1516 0228 8DEDB5A0 		.word	-1598689907
 1517 022c F7C6B03E 		.word	1051772663
 1518 0230 11EA2D81 		.word	-2127697391
 1519 0234 9997513D 		.word	1028757401
 1520 0238 95D626E8 		.word	-400107883
 1521 023c 0B2E013E 		.word	1040264715
 1522 0240 00000000 		.word	.LANCHOR17
 1523 0244 00000000 		.word	.LANCHOR19
 1524 0248 00000000 		.word	.LANCHOR18
 1525 024c 00000000 		.word	.LANCHOR20
 1526 0250 00000000 		.word	.LANCHOR21
 1527 0254 00000000 		.word	.LANCHOR22
 1528              		.cfi_endproc
 1529              	.LFE26:
 1531              		.section	.bss.P11_after.6755,"aw",%nobits
 1532              		.align	2
 1533              		.set	.LANCHOR20,. + 0
 1536              	P11_after.6755:
 1537 0000 00000000 		.space	4
 1538              		.section	.bss.P12_after.6756,"aw",%nobits
 1539              		.align	2
 1540              		.set	.LANCHOR21,. + 0
 1543              	P12_after.6756:
 1544 0000 00000000 		.space	4
 1545              		.section	.bss.P21_after.6757,"aw",%nobits
 1546              		.align	2
 1547              		.set	.LANCHOR19,. + 0
 1550              	P21_after.6757:
 1551 0000 00000000 		.space	4
 1552              		.section	.bss.P22_after.6758,"aw",%nobits
 1553              		.align	2
 1554              		.set	.LANCHOR22,. + 0
 1557              	P22_after.6758:
 1558 0000 00000000 		.space	4
 1559              		.section	.bss.ave_counter.6701,"aw",%nobits
 1560              		.align	1
 1561              		.set	.LANCHOR9,. + 0
 1564              	ave_counter.6701:
 1565 0000 0000     		.space	2
 1566              		.section	.bss.ave_store.6700,"aw",%nobits
 1567              		.align	2
 1568              		.set	.LANCHOR10,. + 0
 1571              	ave_store.6700:
 1572 0000 00000000 		.space	80
 1572      00000000 
 1572      00000000 
 1572      00000000 
 1572      00000000 
 1573              		.section	.bss.est_v.6750,"aw",%nobits
 1574              		.align	2
 1575              		.set	.LANCHOR17,. + 0
 1578              	est_v.6750:
 1579 0000 00000000 		.space	4
 1580              		.section	.bss.est_x.6749,"aw",%nobits
 1581              		.align	2
ARM GAS  C:\Temp\ccj03XTy.s 			page 35


 1582              		.set	.LANCHOR18,. + 0
 1585              	est_x.6749:
 1586 0000 00000000 		.space	4
 1587              		.section	.bss.move_accel_ave,"aw",%nobits
 1588              		.align	2
 1589              		.set	.LANCHOR12,. + 0
 1592              	move_accel_ave:
 1593 0000 00000000 		.space	4
 1594              		.section	.bss.move_length,"aw",%nobits
 1595              		.align	2
 1596              		.set	.LANCHOR13,. + 0
 1599              	move_length:
 1600 0000 00000000 		.space	4
 1601              		.section	.bss.move_speed,"aw",%nobits
 1602              		.align	2
 1603              		.set	.LANCHOR8,. + 0
 1606              	move_speed:
 1607 0000 00000000 		.space	4
 1608              		.section	.bss.move_speed_ave,"aw",%nobits
 1609              		.align	2
 1610              		.set	.LANCHOR11,. + 0
 1613              	move_speed_ave:
 1614 0000 00000000 		.space	4
 1615              		.section	.bss.post_rotation_speed.6729,"aw",%nobits
 1616              		.align	2
 1617              		.set	.LANCHOR14,. + 0
 1620              	post_rotation_speed.6729:
 1621 0000 00000000 		.space	4
 1622              		.section	.bss.rotation_angle,"aw",%nobits
 1623              		.align	2
 1624              		.set	.LANCHOR16,. + 0
 1627              	rotation_angle:
 1628 0000 00000000 		.space	4
 1629              		.section	.bss.rotation_speed,"aw",%nobits
 1630              		.align	2
 1631              		.set	.LANCHOR15,. + 0
 1634              	rotation_speed:
 1635 0000 00000000 		.space	4
 1636              		.section	.bss.tire_l_speed,"aw",%nobits
 1637              		.align	2
 1638              		.set	.LANCHOR3,. + 0
 1641              	tire_l_speed:
 1642 0000 00000000 		.space	4
 1643              		.section	.bss.tire_l_speed_max,"aw",%nobits
 1644              		.align	2
 1645              		.set	.LANCHOR6,. + 0
 1648              	tire_l_speed_max:
 1649 0000 00000000 		.space	4
 1650              		.section	.bss.tire_l_speed_min,"aw",%nobits
 1651              		.align	2
 1652              		.set	.LANCHOR7,. + 0
 1655              	tire_l_speed_min:
 1656 0000 00000000 		.space	4
 1657              		.section	.bss.tire_r_speed,"aw",%nobits
 1658              		.align	2
 1659              		.set	.LANCHOR2,. + 0
 1662              	tire_r_speed:
ARM GAS  C:\Temp\ccj03XTy.s 			page 36


 1663 0000 00000000 		.space	4
 1664              		.section	.bss.tire_r_speed_max,"aw",%nobits
 1665              		.align	2
 1666              		.set	.LANCHOR4,. + 0
 1669              	tire_r_speed_max:
 1670 0000 00000000 		.space	4
 1671              		.section	.bss.tire_r_speed_min,"aw",%nobits
 1672              		.align	2
 1673              		.set	.LANCHOR5,. + 0
 1676              	tire_r_speed_min:
 1677 0000 00000000 		.space	4
 1678              		.section	.data.left_count_old.6661,"aw"
 1679              		.align	1
 1680              		.set	.LANCHOR1,. + 0
 1683              	left_count_old.6661:
 1684 0000 FE7F     		.short	32766
 1685              		.section	.data.right_count_old.6655,"aw"
 1686              		.align	1
 1687              		.set	.LANCHOR0,. + 0
 1690              	right_count_old.6655:
 1691 0000 FE7F     		.short	32766
 1692              		.text
 1693              	.Letext0:
 1694              		.file 2 "c:\\tools\\gcc-arm-none-eabi-9-2019-q4-major\\arm-none-eabi\\include\\machine\\_default_t
 1695              		.file 3 "c:\\tools\\gcc-arm-none-eabi-9-2019-q4-major\\arm-none-eabi\\include\\sys\\lock.h"
 1696              		.file 4 "c:\\tools\\gcc-arm-none-eabi-9-2019-q4-major\\arm-none-eabi\\include\\sys\\_types.h"
 1697              		.file 5 "c:\\tools\\gcc-arm-none-eabi-9-2019-q4-major\\lib\\gcc\\arm-none-eabi\\9.2.1\\include\\st
 1698              		.file 6 "c:\\tools\\gcc-arm-none-eabi-9-2019-q4-major\\arm-none-eabi\\include\\sys\\reent.h"
 1699              		.file 7 "c:\\tools\\gcc-arm-none-eabi-9-2019-q4-major\\arm-none-eabi\\include\\sys\\_stdint.h"
 1700              		.file 8 "Inc/imu.h"
 1701              		.file 9 "Inc/encorder.h"
ARM GAS  C:\Temp\ccj03XTy.s 			page 37


DEFINED SYMBOLS
                            *ABS*:00000000 mouse_state.c
  C:\Temp\ccj03XTy.s:18     .text.Get_diff_right_count:00000000 $t
  C:\Temp\ccj03XTy.s:26     .text.Get_diff_right_count:00000000 Get_diff_right_count
  C:\Temp\ccj03XTy.s:66     .text.Get_diff_right_count:00000014 $d
  C:\Temp\ccj03XTy.s:71     .text.Get_diff_left_count:00000000 $t
  C:\Temp\ccj03XTy.s:78     .text.Get_diff_left_count:00000000 Get_diff_left_count
  C:\Temp\ccj03XTy.s:117    .text.Get_diff_left_count:00000014 $d
  C:\Temp\ccj03XTy.s:122    .text.calc_move_speed:00000000 $t
  C:\Temp\ccj03XTy.s:129    .text.calc_move_speed:00000000 calc_move_speed
  C:\Temp\ccj03XTy.s:263    .text.calc_move_speed:000000c0 $d
  C:\Temp\ccj03XTy.s:278    .text.get_tire_r_speed:00000000 $t
  C:\Temp\ccj03XTy.s:285    .text.get_tire_r_speed:00000000 get_tire_r_speed
  C:\Temp\ccj03XTy.s:300    .text.get_tire_r_speed:00000008 $d
  C:\Temp\ccj03XTy.s:305    .text.get_tire_r_speed_max:00000000 $t
  C:\Temp\ccj03XTy.s:312    .text.get_tire_r_speed_max:00000000 get_tire_r_speed_max
  C:\Temp\ccj03XTy.s:327    .text.get_tire_r_speed_max:00000008 $d
  C:\Temp\ccj03XTy.s:332    .text.get_tire_r_speed_min:00000000 $t
  C:\Temp\ccj03XTy.s:339    .text.get_tire_r_speed_min:00000000 get_tire_r_speed_min
  C:\Temp\ccj03XTy.s:354    .text.get_tire_r_speed_min:00000008 $d
  C:\Temp\ccj03XTy.s:359    .text.get_tire_l_speed:00000000 $t
  C:\Temp\ccj03XTy.s:366    .text.get_tire_l_speed:00000000 get_tire_l_speed
  C:\Temp\ccj03XTy.s:381    .text.get_tire_l_speed:00000008 $d
  C:\Temp\ccj03XTy.s:386    .text.get_tire_l_speed_max:00000000 $t
  C:\Temp\ccj03XTy.s:393    .text.get_tire_l_speed_max:00000000 get_tire_l_speed_max
  C:\Temp\ccj03XTy.s:408    .text.get_tire_l_speed_max:00000008 $d
  C:\Temp\ccj03XTy.s:413    .text.get_tire_l_speed_min:00000000 $t
  C:\Temp\ccj03XTy.s:420    .text.get_tire_l_speed_min:00000000 get_tire_l_speed_min
  C:\Temp\ccj03XTy.s:435    .text.get_tire_l_speed_min:00000008 $d
  C:\Temp\ccj03XTy.s:440    .text.init_tire_speed:00000000 $t
  C:\Temp\ccj03XTy.s:447    .text.init_tire_speed:00000000 init_tire_speed
  C:\Temp\ccj03XTy.s:476    .text.init_tire_speed:00000014 $d
  C:\Temp\ccj03XTy.s:484    .text.get_move_speed:00000000 $t
  C:\Temp\ccj03XTy.s:491    .text.get_move_speed:00000000 get_move_speed
  C:\Temp\ccj03XTy.s:506    .text.get_move_speed:00000008 $d
  C:\Temp\ccj03XTy.s:515    .text.filter_move_speed:00000000 $t
  C:\Temp\ccj03XTy.s:522    .text.filter_move_speed:00000000 filter_move_speed
  C:\Temp\ccj03XTy.s:716    .text.filter_move_speed:000000e8 $d
  C:\Temp\ccj03XTy.s:729    .text.get_move_speed_ave:00000000 $t
  C:\Temp\ccj03XTy.s:736    .text.get_move_speed_ave:00000000 get_move_speed_ave
  C:\Temp\ccj03XTy.s:751    .text.get_move_speed_ave:00000008 $d
  C:\Temp\ccj03XTy.s:756    .text.get_move_accel_ave:00000000 $t
  C:\Temp\ccj03XTy.s:763    .text.get_move_accel_ave:00000000 get_move_accel_ave
  C:\Temp\ccj03XTy.s:778    .text.get_move_accel_ave:00000008 $d
  C:\Temp\ccj03XTy.s:783    .text.calc_move_length:00000000 $t
  C:\Temp\ccj03XTy.s:790    .text.calc_move_length:00000000 calc_move_length
  C:\Temp\ccj03XTy.s:834    .text.calc_move_length:00000038 $d
  C:\Temp\ccj03XTy.s:841    .text.get_move_length:00000000 $t
  C:\Temp\ccj03XTy.s:848    .text.get_move_length:00000000 get_move_length
  C:\Temp\ccj03XTy.s:863    .text.get_move_length:00000008 $d
  C:\Temp\ccj03XTy.s:868    .text.set_move_length:00000000 $t
  C:\Temp\ccj03XTy.s:875    .text.set_move_length:00000000 set_move_length
  C:\Temp\ccj03XTy.s:892    .text.set_move_length:00000008 $d
  C:\Temp\ccj03XTy.s:897    .text.calc_rotation_speed:00000000 $t
  C:\Temp\ccj03XTy.s:904    .text.calc_rotation_speed:00000000 calc_rotation_speed
  C:\Temp\ccj03XTy.s:963    .text.calc_rotation_speed:00000050 $d
  C:\Temp\ccj03XTy.s:972    .text.get_rotation_speed:00000000 $t
ARM GAS  C:\Temp\ccj03XTy.s 			page 38


  C:\Temp\ccj03XTy.s:979    .text.get_rotation_speed:00000000 get_rotation_speed
  C:\Temp\ccj03XTy.s:994    .text.get_rotation_speed:00000008 $d
  C:\Temp\ccj03XTy.s:999    .text.calc_rotation_angle:00000000 $t
  C:\Temp\ccj03XTy.s:1006   .text.calc_rotation_angle:00000000 calc_rotation_angle
  C:\Temp\ccj03XTy.s:1048   .text.calc_rotation_angle:00000030 $d
  C:\Temp\ccj03XTy.s:1056   .text.mouse_state_1ms:00000000 $t
  C:\Temp\ccj03XTy.s:1063   .text.mouse_state_1ms:00000000 mouse_state_1ms
  C:\Temp\ccj03XTy.s:1089   .text.get_rotation_angle:00000000 $t
  C:\Temp\ccj03XTy.s:1096   .text.get_rotation_angle:00000000 get_rotation_angle
  C:\Temp\ccj03XTy.s:1111   .text.get_rotation_angle:00000008 $d
  C:\Temp\ccj03XTy.s:1116   .text.set_rotation_angle:00000000 $t
  C:\Temp\ccj03XTy.s:1123   .text.set_rotation_angle:00000000 set_rotation_angle
  C:\Temp\ccj03XTy.s:1140   .text.set_rotation_angle:00000008 $d
  C:\Temp\ccj03XTy.s:1145   .text.speed_estimate_kalman:00000000 $t
  C:\Temp\ccj03XTy.s:1152   .text.speed_estimate_kalman:00000000 speed_estimate_kalman
  C:\Temp\ccj03XTy.s:1512   .text.speed_estimate_kalman:00000218 $d
  C:\Temp\ccj03XTy.s:1532   .bss.P11_after.6755:00000000 $d
  C:\Temp\ccj03XTy.s:1536   .bss.P11_after.6755:00000000 P11_after.6755
  C:\Temp\ccj03XTy.s:1539   .bss.P12_after.6756:00000000 $d
  C:\Temp\ccj03XTy.s:1543   .bss.P12_after.6756:00000000 P12_after.6756
  C:\Temp\ccj03XTy.s:1546   .bss.P21_after.6757:00000000 $d
  C:\Temp\ccj03XTy.s:1550   .bss.P21_after.6757:00000000 P21_after.6757
  C:\Temp\ccj03XTy.s:1553   .bss.P22_after.6758:00000000 $d
  C:\Temp\ccj03XTy.s:1557   .bss.P22_after.6758:00000000 P22_after.6758
  C:\Temp\ccj03XTy.s:1560   .bss.ave_counter.6701:00000000 $d
  C:\Temp\ccj03XTy.s:1564   .bss.ave_counter.6701:00000000 ave_counter.6701
  C:\Temp\ccj03XTy.s:1567   .bss.ave_store.6700:00000000 $d
  C:\Temp\ccj03XTy.s:1571   .bss.ave_store.6700:00000000 ave_store.6700
  C:\Temp\ccj03XTy.s:1574   .bss.est_v.6750:00000000 $d
  C:\Temp\ccj03XTy.s:1578   .bss.est_v.6750:00000000 est_v.6750
  C:\Temp\ccj03XTy.s:1581   .bss.est_x.6749:00000000 $d
  C:\Temp\ccj03XTy.s:1585   .bss.est_x.6749:00000000 est_x.6749
  C:\Temp\ccj03XTy.s:1588   .bss.move_accel_ave:00000000 $d
  C:\Temp\ccj03XTy.s:1592   .bss.move_accel_ave:00000000 move_accel_ave
  C:\Temp\ccj03XTy.s:1595   .bss.move_length:00000000 $d
  C:\Temp\ccj03XTy.s:1599   .bss.move_length:00000000 move_length
  C:\Temp\ccj03XTy.s:1602   .bss.move_speed:00000000 $d
  C:\Temp\ccj03XTy.s:1606   .bss.move_speed:00000000 move_speed
  C:\Temp\ccj03XTy.s:1609   .bss.move_speed_ave:00000000 $d
  C:\Temp\ccj03XTy.s:1613   .bss.move_speed_ave:00000000 move_speed_ave
  C:\Temp\ccj03XTy.s:1616   .bss.post_rotation_speed.6729:00000000 $d
  C:\Temp\ccj03XTy.s:1620   .bss.post_rotation_speed.6729:00000000 post_rotation_speed.6729
  C:\Temp\ccj03XTy.s:1623   .bss.rotation_angle:00000000 $d
  C:\Temp\ccj03XTy.s:1627   .bss.rotation_angle:00000000 rotation_angle
  C:\Temp\ccj03XTy.s:1630   .bss.rotation_speed:00000000 $d
  C:\Temp\ccj03XTy.s:1634   .bss.rotation_speed:00000000 rotation_speed
  C:\Temp\ccj03XTy.s:1637   .bss.tire_l_speed:00000000 $d
  C:\Temp\ccj03XTy.s:1641   .bss.tire_l_speed:00000000 tire_l_speed
  C:\Temp\ccj03XTy.s:1644   .bss.tire_l_speed_max:00000000 $d
  C:\Temp\ccj03XTy.s:1648   .bss.tire_l_speed_max:00000000 tire_l_speed_max
  C:\Temp\ccj03XTy.s:1651   .bss.tire_l_speed_min:00000000 $d
  C:\Temp\ccj03XTy.s:1655   .bss.tire_l_speed_min:00000000 tire_l_speed_min
  C:\Temp\ccj03XTy.s:1658   .bss.tire_r_speed:00000000 $d
  C:\Temp\ccj03XTy.s:1662   .bss.tire_r_speed:00000000 tire_r_speed
  C:\Temp\ccj03XTy.s:1665   .bss.tire_r_speed_max:00000000 $d
  C:\Temp\ccj03XTy.s:1669   .bss.tire_r_speed_max:00000000 tire_r_speed_max
  C:\Temp\ccj03XTy.s:1672   .bss.tire_r_speed_min:00000000 $d
ARM GAS  C:\Temp\ccj03XTy.s 			page 39


  C:\Temp\ccj03XTy.s:1676   .bss.tire_r_speed_min:00000000 tire_r_speed_min
  C:\Temp\ccj03XTy.s:1679   .data.left_count_old.6661:00000000 $d
  C:\Temp\ccj03XTy.s:1683   .data.left_count_old.6661:00000000 left_count_old.6661
  C:\Temp\ccj03XTy.s:1686   .data.right_count_old.6655:00000000 $d
  C:\Temp\ccj03XTy.s:1690   .data.right_count_old.6655:00000000 right_count_old.6655

UNDEFINED SYMBOLS
get_encordercount_r
get_encordercount_l
__aeabi_f2d
__aeabi_dmul
__aeabi_dadd
__aeabi_d2f
IMU_GetAccel_X
IMU_GetGyro_Z
